(window.webpackJsonp=window.webpackJsonp||[]).push([["bundles/37d6fe1fee6fb6accf5867cbca2cda9c"],{"1y80":function(e,t,n){"use strict";function r(e,t,n,r,a){return window.statlogsValueEvent(e,t,n,r,a)}function a(e){return Math.random()<e}function i(e,t,n,i,c,o){a(e)&&r(t,n,i,c,o)}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i})},"86+7":function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return c});n("KKXr");var r=n("aong");function a(e,t){return t in Object(r.r)(e).oCache}function i(e,t){var n=Object(r.r)(e).oCache[t];return n&&!n._n&&(!function(e){if(!e.first_name){var t=e.name.split(" ",2);e.first_name=t[0],e.short_name=t[1]?t[0]+" "+t[1].substr(0,1)+".":t[0]}e.inv_name||(e.inv_name=e.name),e.kick_name||(e.kick_name=e.inv_name)}(n),n._n=1),n}function c(e,t){var n=Object(r.r)(e);n.oCache||(n.oCache={}),t.id&&(n.oCache[t.id]=t)}},BxOC:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var{ajax:r}=window,a=(n("Btvt"),2);function i(e,t,n){return t&&(t.im_v=a),new Promise((a,i)=>{r.post(e,t,{timeout:n,onDone(){a.apply(null,[[...arguments]])},onFail(){return i.apply(null,arguments),!0}})})}function c(e,t,n={}){var a;return a=window.XDomainRequest?new XDomainRequest:r._getreq(),{request:new Promise((r,i)=>{var c,o=Date.now(),s=n.timeout||60,u=ajx2q(t);if(window.XDomainRequest)a.open("get",`${e}?${u}`),a.ontimeout=function(e){i([e,{}])},a.onerror=function(e){i([e,{}])},a.onload=function(){r([a.responseText,{}])},setTimeout(function(){a.send()},0);else{a.onreadystatechange=function(){4==a.readyState&&(clearInterval(c),a.status>=200&&a.status<300?r([a.responseText,a]):i([a.responseText,a]))};try{a.open("GET",`${e}?${u}`,!0)}catch(e){return i([e,a])}a.send()}c=setInterval(function(){Date.now()-o>1e3*s&&(window.browser.safari&&a.abort(),i(["",{}]),clearInterval(c))},1e3)}),cancel:function(){a.abort()}}}},DM26:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c}),n.d(t,"d",function(){return o});n("Btvt");function r(e,t){return new Promise(n=>{setTimeout(n.bind(null,t),1e3*e)})}function a(e,t,n=null){var a=0;return function i(...c){return Promise.resolve().then(()=>e(...c)).catch(e=>{if(++a<=t){var o="function"==typeof n?n(a):0;return 0===o?i(...c):r(o).then(()=>i(...c))}throw e})}}function i(e,t,n){var r,a;return function(...i){return new Promise((e,c)=>{var o=n&&!r;clearTimeout(r),a&&a.reject("debounce"),r=setTimeout(function(){r=null,a=null,n||e(i)},t),o?e(i):n&&c("debounce"),a={resolve:e,reject:c}}).then(t=>e(...t))}}function c(e,t){var n,r=new Promise(r=>{n=r,setTimeout(r.bind(null,t),1e3*e)});return{pause:()=>r,abort(){n(t)}}}function o(e){return(...t)=>new Promise(n=>e(...t,n))}},ERyv:function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"e",function(){return m});n("Btvt");var r,a=n("BxOC"),i=n("DM26"),c=1;function o(e,t,n,a,i){if("Script error."!==e){var c=i?i.stack||i.message:null;d("unhandled_error",c?{err:e,stack:c}:{err:e})}r&&r.apply(this,arguments)}function s(e){e.preventDefault()}function u(){return!!window.imwl}function d(e,t,n=!0){u()&&(n&&window.console&&(console.error(e,t),console.trace&&console.trace()),Object(i.e)(a.b,3,()=>2)("al_im.php",{act:"a_weird_log",kind:e,data:JSON.stringify(extend({errIdx:c++,ua:navigator.userAgent},t))}))}function l(e,t,n={}){return d(e,extend({err:t&&t.message||t},n)),Promise.reject(t)}function f(){r=window.onerror,window.onerror=o,window.addEventListener("unhandledrejection",s)}function m(){window.onerror=r,r=void 0,window.removeEventListener("unhandledrejection",s)}},MhhX:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"l",function(){return c}),n.d(t,"e",function(){return o}),n.d(t,"k",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"g",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"m",function(){return m}),n.d(t,"f",function(){return b}),n.d(t,"i",function(){return _}),n.d(t,"j",function(){return h}),n.d(t,"o",function(){return p}),n.d(t,"h",function(){return g}),n.d(t,"b",function(){return v}),n.d(t,"a",function(){return j}),n.d(t,"p",function(){return y});n("OEbY");var r=n("f01n"),a=n("aong");function i(e,t){return"number"!=typeof t.messageId||(s(t)?t.messageId>e.out_up_to:t.messageId>e.in_up_to)}function c(e){return e.kludges&&void 0!==e.kludges.source_act}function o(e){return"call"==e.kludges.attach1_type}function s(e){return e.flags&r.m}function u(e){var t=e.attaches.filter(e=>"mail"===e.type).length>0;return e.attaches.filter(e=>"reply"===e.type).length>0||e.flags&r.k&&t}function d(e,t,n=null){var r=e.attaches[0];return r&&(r.type===t||r.type===n)}function l(e){return d(e,"doc")&&"graffiti"===e.attaches[0].kind}function f(e){return Boolean(e.attaches.find(e=>"doc"===e.type&&"audiomsg"===e.kind))}function m(e){return Boolean(e.attaches.find(e=>"sticker"===e.type))}function b(e){return d(e,"gift")}function _(e){return d(e,"money_transfer","money_request")}function h(e){return d(e,"money_request")}function p(e){return d(e,"link","vkpay")&&6217559==e.kludges.attach1_app_id}function g(e){return e.flags&r.l}function v(e){return s(e)?vk.id:e.userId}function j(e,t){var n=Object(a.r)(e);return s(t)?n.id:t.userId}function y(e){return e.update_time>0}},O8ze:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"g",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"f",function(){return u}),n.d(t,"k",function(){return l}),n.d(t,"m",function(){return f}),n.d(t,"l",function(){return m}),n.d(t,"h",function(){return b}),n.d(t,"i",function(){return h}),n.d(t,"j",function(){return p}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return v}),n.d(t,"a",function(){return j});n("pIFo");var r=n("1y80"),a=n("aong"),i={};function c(e){Object(r.b)(.1,"im_forward_stat",d(e),!!e.get().gid)}function o(e,t){Object(r.b)(.1,"im_forward_from_community_stat",d(e),!!e.get().gid,+t)}function s(){Object(r.b)(1,"im_apply_community_template_stat",1)}function u(){Object(r.b)(1,"messages_channel_forward_click",1)}function d(e){var t=e.get().pendingForward;return+(t&&t.msgIds&&t.msgIds.length)}function l(e,t,n,a=!1){if(!Object(r.a)(1))return()=>{};var i=+new Date,c=_(e);return function(){var e=+new Date-i;Object(r.c)("messages_send_time_web",e,t,n,c,a)}}function f(e,t,n,r){if(t.messageId&&-1!==String(t.messageId).indexOf("rid")){var a=[t.messageId.replace("rid",""),n,r].join("_"),c=t.attaches.length>0;i[a]=l(e,n,r,c)}}function m(e,t,n,r){var a=[t.randomId,n,r].join("_"),c=i[a];c&&(c(),delete i[a])}function b(e,t,n,a){var i=_(e),c=""===t?"network":"unknown";Object(r.a)(1)&&Object(r.c)("messages_send_errors_web",c,n,a,i)}function _(e){var t=Object(a.r)(e);return Boolean(t.longpoll&&t.longpoll.isEnabled&&t.longpoll.isEnabled())}function h(e){var t=Object(a.r)(e),n=t.imQueue(t.peer).length;Object(r.a)(1)&&Object(r.c)("messages_send_queue_size",n)}function p(e,t="unknown"){Object(r.a)(1)&&Object(r.c)("messages_send_retry",1,t,e)}function g(){var e="im_browser_notifications_users";ls.get(e)||ls.get("im_ui_notify_off")||(ls.set(e,1),Object(r.c)(e,1))}function v(){Object(r.b)(1,"im_browser_notifications_on",1)}function j(){Object(r.b)(1,"im_browser_notifications_off",1)}},P13b:function(e,t,n){"use strict";n("Vd3H"),n("rGqo"),n("a1Th"),n("tUrg"),n("pIFo"),n("KKXr"),n("Btvt");var r=n("f01n"),a=n("h++7"),i=n("nyd8"),c=n("rHUl"),o=n("MhhX"),s=n("p3re"),u=n("eTng"),d=n("vT4u"),l=n("N1NS"),f="_im_join_chat";function m(e,t){var n=Object(l.a)({handlers:(n,a)=>{a(e,"click",f,e=>(function(e,t){var n=domData(t,"chat-id"),a=domData(t,"hash");return lockButton(t),Object(d.Z)(n,a,e.get()).then(([n])=>{unlockButton(t),e.get().longpoll.push([Object(r.gb)(n)])}).catch(e=>{showFastBox(getLang("mail_join_invite_error_title"),e),unlockButton(t)})})(t,e.target))}});return{unmount(){Object(l.c)(n)}}}var b=n("aong"),_=n("86+7"),h=n("Wu9C"),p=n("wSs/"),g=n("ERyv"),v=n("lJdi"),j=n("t7n3");n.d(t,"t",function(){return y}),n.d(t,"l",function(){return k}),n.d(t,"s",function(){return w}),n.d(t,"v",function(){return I}),n.d(t,"j",function(){return x}),n.d(t,"g",function(){return P}),n.d(t,"b",function(){return D}),n.d(t,"c",function(){return $}),n.d(t,"e",function(){return T}),n.d(t,"d",function(){return q}),n.d(t,"f",function(){return S}),n.d(t,"h",function(){return E}),n.d(t,"a",function(){return A}),n.d(t,"k",function(){return C}),n.d(t,"o",function(){return z}),n.d(t,"m",function(){return M}),n.d(t,"n",function(){return N}),n.d(t,"p",function(){return H}),n.d(t,"i",function(){return B}),n.d(t,"u",function(){return L}),n.d(t,"q",function(){return F}),n.d(t,"r",function(){return R}),n.d(t,"V",function(){return Re}),n.d(t,"lc",function(){return Ue}),n.d(t,"M",function(){return Ke}),n.d(t,"y",function(){return Xe}),n.d(t,"H",function(){return Je}),n.d(t,"gb",function(){return Qe}),n.d(t,"gc",function(){return Ge}),n.d(t,"Ib",function(){return Ze}),n.d(t,"R",function(){return We}),n.d(t,"J",function(){return et}),n.d(t,"Lc",function(){return tt}),n.d(t,"K",function(){return nt}),n.d(t,"Xb",function(){return at}),n.d(t,"L",function(){return it}),n.d(t,"x",function(){return ot}),n.d(t,"jc",function(){return st}),n.d(t,"Lb",function(){return ut}),n.d(t,"fc",function(){return dt}),n.d(t,"nb",function(){return lt}),n.d(t,"mb",function(){return ft}),n.d(t,"wb",function(){return mt}),n.d(t,"rb",function(){return bt}),n.d(t,"Db",function(){return _t}),n.d(t,"Eb",function(){return ht}),n.d(t,"I",function(){return yt}),n.d(t,"Jc",function(){return kt}),n.d(t,"Dc",function(){return Ot}),n.d(t,"D",function(){return wt}),n.d(t,"Zb",function(){return Dt}),n.d(t,"Sb",function(){return $t}),n.d(t,"Yb",function(){return Tt}),n.d(t,"Ub",function(){return qt}),n.d(t,"bc",function(){return St}),n.d(t,"Tb",function(){return Et}),n.d(t,"cc",function(){return At}),n.d(t,"mc",function(){return Ct}),n.d(t,"Fc",function(){return zt}),n.d(t,"Ob",function(){return Mt}),n.d(t,"Qb",function(){return Ht}),n.d(t,"Pb",function(){return Bt}),n.d(t,"ic",function(){return Lt}),n.d(t,"P",function(){return Ft}),n.d(t,"Jb",function(){return Rt}),n.d(t,"Vb",function(){return Kt}),n.d(t,"kc",function(){return Xt}),n.d(t,"dc",function(){return Jt}),n.d(t,"w",function(){return Vt}),n.d(t,"hc",function(){return Qt}),n.d(t,"Cb",function(){return Gt}),n.d(t,"Bc",function(){return Zt}),n.d(t,"Oc",function(){return Wt}),n.d(t,"Gc",function(){return Yt}),n.d(t,"F",function(){return en}),n.d(t,"Wb",function(){return tn}),n.d(t,"rc",function(){return nn}),n.d(t,"tc",function(){return rn}),n.d(t,"zc",function(){return an}),n.d(t,"vc",function(){return cn}),n.d(t,"G",function(){return on}),n.d(t,"fb",function(){return sn}),n.d(t,"Ic",function(){return un}),n.d(t,"Ac",function(){return dn}),n.d(t,"C",function(){return ln}),n.d(t,"sb",function(){return fn}),n.d(t,"Fb",function(){return mn}),n.d(t,"xb",function(){return bn}),n.d(t,"zb",function(){return _n}),n.d(t,"yb",function(){return hn}),n.d(t,"z",function(){return pn}),n.d(t,"yc",function(){return gn}),n.d(t,"X",function(){return vn}),n.d(t,"W",function(){return jn}),n.d(t,"oc",function(){return kn}),n.d(t,"nc",function(){return On}),n.d(t,"T",function(){return wn}),n.d(t,"qc",function(){return In}),n.d(t,"ob",function(){return xn}),n.d(t,"Nc",function(){return Pn}),n.d(t,"Rb",function(){return Dn}),n.d(t,"vb",function(){return $n}),n.d(t,"db",function(){return Tn}),n.d(t,"bb",function(){return qn}),n.d(t,"cb",function(){return Sn}),n.d(t,"eb",function(){return En}),n.d(t,"ec",function(){return An}),n.d(t,"Kb",function(){return zn}),n.d(t,"Kc",function(){return Mn}),n.d(t,"ac",function(){return Nn}),n.d(t,"uc",function(){return Hn}),n.d(t,"pc",function(){return Bn}),n.d(t,"Z",function(){return Ln}),n.d(t,"A",function(){return Fn}),n.d(t,"wc",function(){return Rn}),n.d(t,"xc",function(){return Un}),n.d(t,"Gb",function(){return Kn}),n.d(t,"Q",function(){return Xn}),n.d(t,"Mb",function(){return Jn}),n.d(t,"Nb",function(){return Vn}),n.d(t,"Ec",function(){return Qn}),n.d(t,"ub",function(){return Gn}),n.d(t,"sc",function(){return Zn}),n.d(t,"Cc",function(){return Wn}),n.d(t,"B",function(){return Yn}),n.d(t,"U",function(){return er}),n.d(t,"O",function(){return tr}),n.d(t,"N",function(){return nr}),n.d(t,"Y",function(){return rr}),n.d(t,"E",function(){return ar}),n.d(t,"Mc",function(){return ir}),n.d(t,"ab",function(){return c.u}),n.d(t,"jb",function(){return c.A}),n.d(t,"tb",function(){return c.H}),n.d(t,"pb",function(){return c.E}),n.d(t,"kb",function(){return c.C}),n.d(t,"S",function(){return c.f}),n.d(t,"Bb",function(){return c.L}),n.d(t,"qb",function(){return c.F}),n.d(t,"lb",function(){return c.D}),n.d(t,"hb",function(){return c.y}),n.d(t,"Hc",function(){return c.U}),n.d(t,"ib",function(){return u.b}),n.d(t,"Hb",function(){return u.d}),n.d(t,"Ab",function(){return u.c});var y="_im_mess_sending",k="_im_mess_failed",O="_im_mess_original",w="_im_mess_restore",I="_im_typing",x="chat_create",P="chat_title_update",D="chat_invite_user",$="chat_kick_user",T="chat_photo_update",q="chat_photo_remove",S="chat_pin_message",E="chat_unpin_message",A="chat_invite_user_by_link",C="_im_deselect_all",z="_im_top_notice_hide",M="_im_aside_notice_hide",N="_im_aside_promo_block_hide",H="_im_vkadmin_promo_link",B="_im_clear_recent",L="_im_toggle_mr_tab",F="_im_mess_search",R="_im_pinned",{vk:U,ls:K,se:X,re:J,rs:V,sech:Q,inArray:G,intval:Z,trim:W,stripHTML:Y,domFC:ee,domPS:te,domLC:ne,domChildren:re,domClosestSibling:ae,domData:ie,geByClass:ce,geByClass1:oe,gpeByClass:se,addClass:ue,removeClass:de,toggleClass:le,hasClass:fe,attr:me,setStyle:be,val:_e,getTemplate:he,getLang:pe,langSex:ge,langDate:ve,langNumeric:je,getDateText:ye,getSmDate:ke,getShortDate:Oe,isSameDate:we,isToday:Ie,ajax:xe,showBox:Pe,showFastBox:De,showTabbedBox:$e,showTooltip:Te,mobPlatforms:qe,onlinePlatformClass:Se,AudioMessagePlayer:Ee,Emoji:Ae,slideUp:Ce,fadeOut:ze,cancelEvent:Me}=window,Ne=4096,He=100,Be=8,Le=52,Fe="chatPosition";function Re(){return K.get(Fe)||0}function Ue(e){e>=window.clientHeight()-30&&(e=0),K.set(Fe,e)}function Ke(e,t){var n=oe(e,t);n.firstElementChild.offsetHeight!==n.parentNode.offsetHeight&&be(n.firstElementChild,{height:n.parentNode.offsetHeight})}function Xe(e,t){e&&e.innerHTML!==t&&(e.innerHTML=t)}function Je(e,t,n,r){var a=t&&!n?1:!t&&n?-1:0;a&&!Object(c.A)(e)&&r().compensateHistoryHeightChange(a)}function Ve(e,t,n,r){var a=window.devicePixelRatio>=2?"256":"128",i="animation"===n,c="im_gift";i&&(c+=" sticker_img");var o=`<img height="128" class="${c}" src="${Stickers.getStickerUrl(Z(e),a)}"/>`;if(i){var s="animatedSticker"+r;o=`<div id="${s}" data-loop-count=3 data-animation-path="${"/stickers.php?act=proxy_animation&product_id="+t+"&sticker_id="+e}" onmouseenter="StickersAnimation.loadAndPlaySticker(this);"\n     data-uniq-id="${r}" data-sticker-id="${Z(e)}" class="sticker_animation sticker_animation_128 im_gift">${o}</div>`;var u=!1;browser.msie?(0^r)===r&&(u=!0):u=Number.isInteger(r),u&&window.StickersSettings.getAutoplay()&&window.StickersAnimation&&window.StickersAnimation.loadAndPlayStickerWithTimer(s,10)}return t&&(o=`<a onmouseover="return Emoji.stickerOver(${Z(e)}, this);"\n        onclick="return Emoji.clickSticker(${Z(t)}, this, event);">${o}</a>`),o=`<div class="im_sticker_row">${o}</div>`}function Qe(e,t,n){var r=e.get?e.get():e;if(_t(r,t)){var a=r.tabs[t].deleted||[];return G(n,a)}return!1}function Ge(e,t,n){var r=n.randomId,a=oe(`_im_mess_rid${r}`,t);return a&&(t=ot(e,n,t=Nt([a],t),!0,!1)),t}function Ze(e){var t=Object(c.a)(e);return browser.mobile&&browser.safari?Promise.resolve(!1):void 0!==t?Promise.resolve(t):We().then(e=>e.length>0).catch(e=>!1)}function We(){return window.AudioContext&&navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(function(e){for(var t=[],n=0;n<e.length;n++)"audioinput"==e[n].kind&&t.push(e[n]);return t}):Promise.reject(new Error("NotSupported"))}function Ye(e){return he("im_preloader",{preloader:V(U.pr_tpl,{id:""}),cls:`im-preloader_attach im-preloader_visible im-preloader_${e}`})}function et(e){var t=e.split(".");return(t[0]<10?"0":"")+t[0]+(t[1]<10?"0":"")+t[1]+t[2]}function tt(e,t,n){var r=ie(n,"msgid"),a=oe(`_im_mess_${r}`,t),i=n.cloneNode(!0);return a&&(a.parentNode.replaceChild(i,a),it(t)),t}function nt(e,t,n){var r=rt(e,t),a=oe(`_im_mess_${t.messageId}`,n);return a&&(a.parentNode.replaceChild(X(r),a),it(n)),n}function rt(e,t){var n=["_im_mess"],r=Object(o.n)(e.tabs[t.peerId],t),a=Object(o.c)(t)?he("im_message_media",{type:"reply",messageId:t.messageId,attaches:Ye("reply"),text:""}):"";Object(o.k)(t)&&r&&n.push("im-mess_unread _im_mess_unread"),Object(o.k)(t)&&n.push("im-mess_out"),Object(o.p)(t)&&n.push("im-mess_was_edited"),Object(p.a)(e,t)&&n.push("im-mess_editable"),Object(o.h)(t)&&n.push("im-mess_fav"),-1!=(e.selectedMessages||[]).indexOf(t.messageId)&&n.push("im-mess_selected");var i=Date.now()-1e3*t.date>1e3;t.local&&i&&n.push("im-mess_sending"),t.local&&n.push(`${y}`),t.local&&Object(o.p)(t)&&!r&&n.push("im-mess_unread im-mess_nobg"),t.failed&&n.push(`im-mess_failed ${k}`),Object(o.f)(t)&&n.push("im-mess_gift");var d=at(t),l=function(e,t){var n="",r=Object(b.r)(e).sourceEnabled&&t.kludges&&t.kludges.from_widget&&t.kludges.ref_source;Object(o.p)(t)&&(n+=he("sImLblWasEdited",{update_time:t.update_time}));if(Object(c.C)(e)&&r){var a=t.kludges.ref_source,i={};try{(i=JSON.parse(Object(j.I)(a))).link&&i.info&&(i.link=Object(s.e)(Object(j.c)(i.link),s.b.bind(null,!1)),i=Object(j.c)(langStr(pe("mail_source_info"),"link",i.link,"info",Object(j.c)(i.info))),n+=he("sImLblWasSourceInfo",{source:i}))}catch(e){}}return n}(e,t),f=a+jt(e,t.text,t.kludges,!1,t.peerId);""!=f&&(f+=l),t.subject&&"..."!==t.subject.trim()&&!Object(u.b)(t.peerId)&&(f=he("im_topic",{topic:t.subject})+f);var m=he("im_message_media",{type:"media",messageId:t.messageId,attaches:d.join(""),text:Object(o.f)(t)?`<div class="im-mess--gift-lbl">${f}</div>`:""});return Object(o.f)(t)||(m=f+m),""==f&&(m+=l),he("im_msg_row",{msg_id:t.messageId,from_id:t.peerId,aria_hidden:t.local&&!t.failed?"true":"false",ts:t.date,marker_params:t.failed?`aria-label="${pe("mail_send_message_error")}" role="link"`:"",unread_params:r?`aria-label="${pe("mail_unread_message")}"`:"",cls:n.join(" ")}).replace("%text%",()=>m)}function at(e){return e.attaches.reduce((t,n)=>!Object(o.c)(e)||"mail"!==n.type&&"reply"!==n.type?("sticker"===n.type?e.messageId?t.push(Ve(n.id,n.productId,n.kind,e.messageId)):t.push(Ve(n.id,n.productId)):t.push(Ye(n.type)),t):t,[])}function it(e){for(var t=e.getElementsByClassName("_im_mess_noa"),n=t.length;n--;)fe(t[n],"im-mess_fwd")||t[n].insertAdjacentHTML("afterbegin",he("sImHistoryRowActions")),de(t[n],"_im_mess_noa")}function ct(e,t,n){var r,a=U.id,i=e.attaches[0],c=i.initiatorId,o=i.state,s=i.receiverId;switch(o){case"reached":r=pe(a===c?"mail_call_outgoing":"mail_call_incoming");var u=t?"":function(e){var t=Math.floor(e/3600),n=Math.floor(e/60)-60*t,r=!1,a=!1;return[t,n,e-3600*t-60*n].reduce((e,t)=>{if(0===t&&!a)return a=!0,e;r&&(t=t<10?"0"+t:t);var n=`${e}${""!==e?":":""}${t}`;return r=!0,a=!0,n},"")}(i.duration);r=r.replace("{duration}",u);break;case"canceled_by_initiator":r=pe(a===c?"mail_call_canceled":"mail_call_missed");break;case"canceled_by_receiver":if(a===c){if(t)return pe("mail_call_declined");var d=Object(_.c)(n,s);return d?ge(d.sex,pe("mail_call_declined_by","raw")).replace("{user_name}",d.first_name):pe("mail_call_declined")}return pe("mail_call_canceled");default:r=pe("mail_added_call")}return he("im_calls_link",{text:r})}function ot(e,t,n,r=!0,a=!0,i=!0){var s=Date.now()-1e3*t.date>1e3,d=e.tabs[t.peerId];if(!n||oe("_im_mess",n)||oe("_im_bar_date",n)||(n.innerHTML=""),d.skipped>0)return n;var l=[];t.local||(l=e.imQueue(t.peerId,a)),l.length>0&&Nt(l.map(e=>oe("_im_mess_rid"+e.rid,n),n).filter(e=>e));var f=rt(e,t),m=ne(n);fe(m,"_im_mess_stack")||(m=ae(m,"._im_mess_stack",-1));for(var h=Object(c.l)(e,t.peerId,t.messageId);t.peerId===e.peer&&h&&!oe("_im_mess_"+h.messageId);)h=Object(c.l)(e,t.peerId,h.messageId);var p=oe("_im_unread_bar_row",n),g=Object(o.b)(t),v=h?pt(h.date,e):0;if(!h||gt(d,h,t,e,i)){var j="",k=!1;if(p&&Object(o.k)(t)&&Dn(e,n,t.peerId),1===d.unread&&!Object(o.k)(t)&&i&&(j+=he("im_mess_bar",{}),k=!0,Dn(e,n,t.peerId)),!Ie(new Date(v))){var O=new Date,w=k?"im-page--history-new-bar_hide _im_invisible_bar":"";j+=he("im_day_bar",{day:Oe(t.date,e.timeshift,!0,pe("months_of","raw"),!0),date:t.date,day_class:O.getDate()+O.getMonth()+O.getFullYear()+" "+w})}if(Object(o.l)(t))j+=he("im_service_row",{text:Jt(e,t,d),type:"",date:t.date,from_id:"",message_id:t.messageId});else if(Object(o.e)(t))j+=he("im_service_row",{text:Xt("",ct(t,!1,e),""),type:"",date:t.date,from_id:"",message_id:t.messageId});else{var I=e.gid&&Object(o.k)(t)?Z(t.kludges.from_admin)||-e.gid:0,x=Object(_.c)(e,I?-e.gid:g)||d,P=Object(u.b)(t.peerId)?x.name:x.first_name,D=x.link||d.href,$=he("im_mess_stack_name",{name:P,link:D,class:Object(o.i)(t)?" im-mess-stack--lnk-money-transfer":""});if(Object(o.f)(t)){var T=pe("mail_gift_message_sent","raw");$+=` <span class="im-mess-stack--gift">${ge(x.sex||0,T)}</span>`}if(Object(o.i)(t)){var q=Object(o.j)(t)?pe("mail_money_request_message_sent","raw"):pe("mail_money_tranfer_message_sent","raw");$+=` <span class="im-mess-stack--money-transfer">${ge(x.sex||0,q)}</span>`}var S,E=e.gid?"/gim"+e.gid:"/im";if(S=t.local?vt(t.date,e.timeshift):he("im_stack_date",{date:vt(t.date,e.timeshift),link:`${E}?sel=${t.peerId}&msgid=${t.messageId}`}),I&&e.admins[I]){var A=e.admins[I],C=I===U.id?pe("mail_by_you"):A[0];S=S+" "+he("im_admin_link",{name:C,href:A[1]})}j+=he("im_mess_stack",{photo:x.photo,href:D,cls:"",date_attr:"",link:`/im?sel=${t.peerId}&msgid=${t.messageId}`,name:Y($),stack_name:$,peerId:g,date:S,messages:f,admin:t.kludges.from_admin||0})}Object(b.p)(Q(j)).forEach(e=>n&&n.appendChild(e))}else p&&e.peer===t.peerId&&!d.inplaceSearch&&Object(o.k)(t)&&Dn(e,n,t.peerId),oe("_im_stack_messages",m).appendChild(X(f));return Object(o.k)(t)&&!s&&setTimeout(()=>{var e=oe("_im_mess_"+t.messageId,n);fe(e,y)&&ue(e,"im-mess_sending")},500),l=l.filter(e=>e.rid!==t.randomId),it(n),st(l,e,n)}function st(e,t,n){var r;return(r="object"==typeof e?e:t.imQueue(e,!1)).length>0&&r.map(e=>(e.mess.failed=!!e.failed,e.mess)).filter(e=>Object(c.n)(t,e.peerId,e.messageId)).forEach(e=>ot(t,e,n,!1)),n}function ut(e,t,n){var r=e.tabs[t];return Object(b.p)(ce("_im_mess_unread",n)).forEach(e=>{var t=Z(ie(e,"msgid"));t>0&&r.out_up_to>=t&&(de(e,"_im_mess_unread"),de(e,"im-mess_unread"),function(e){var t=oe("_im_mess_blind_unread_marker",e);t&&(t.removeAttribute("aria-label"),t.removeAttribute("role"),t.removeAttribute("tabindex"))}(e))}),n}function dt(e,t,n){var{peerId:r,messageId:a}=t,i=oe("_im_msg_reply"+a,e),c=oe("_im_msg_media"+a,e),o=n.tabs[r].mediacontent[a][0];return i&&(i.innerHTML=o[0]),c&&(c.innerHTML=o[1]),e}function lt(e,t){if(!Object(c.F)(t,e.peerId))return 0;var n=t.tabs[e.peerId];return n.msgs[e.messageId]?1:n.msgs["rid"+e.randomId]?2:0}function ft(e){return e>19e8&&e<2e9}function mt(e,t){return e===t.peer}function bt(e,t){return Object(v.m)(Object(c.u)(e,t),1024)}function _t(e,t){return!!e.tabs[t]}function ht(e,t){return!!_t(e,t)&&null!==e.tabs[t].lastmsg}function pt(e,t){return 1e3*e+1e3*t.timeshift}function gt(e,t,n,r,a){if(Object(o.b)(t)!==Object(o.b)(n))return!0;var i=pt(t.date,r),s=pt(n.date,r);return!we(i,s)||(!(!Object(c.C)(r)||Z(t.kludges.from_admin)===Z(n.kludges.from_admin))||(n.date-t.date>300||(!(!Object(o.l)(t)&&!Object(o.l)(n))||(!(!Object(o.e)(n)&&!Object(o.e)(t))||(!(!Object(o.f)(t)&&!Object(o.f)(n))||(!(!Object(o.g)(t)&&!Object(o.g)(n))||(!!Object(o.c)(n)||!(Object(o.n)(e,t)===Object(o.n)(e,n)||!a||Object(o.k)(n)||Gt(n.peerId,r.gid)))))))))}function vt(e,t){return ve(1e3*e,"{hour}:{minute} {am_pm}",1e3*t,[],!0)}function jt(e,t,n,r=!1,a=!1){var i=Math.round(1e9*Math.random()).toString(16),o={},u=0;return t=(t=Object(s.e)(t||"",s.b.bind(null,r))).replace(/(<a.+?<\/a>)/gi,e=>{var t=`!link_${u}_${i}!`;return o[t]=e,u++,t}),t=Object(s.f)(t),t=Object(s.c)(t),t=Object(s.d)(t,t=>{var n=Object(c.j)(e);return`<a href="/${n?"gim"+n:"im"}?sel=${a||Object(c.p)(e)}&st=${encodeURIComponent(t)}">${t}</a>`}),Object.keys(o).forEach(e=>{t=t.replace(e,()=>o[e])}),n.emoji&&(t=Ae.emojiToHTML(t,!0)),t}function yt(e){return Object(u.b)(e)?"c"+(e-2e9):function(e){return e<-2e9}(e)?"e"+Math.abs(e+2e9):ft(e)?"mr"+(e-19e8):e}function kt(e){switch(e.substr(0,1)){case"e":return-2e9-Z(e.substr(1));case"c":return 2e9+Z(e.substr(1));default:return Z(e)}}function Ot(e){return e>9999999?Math.floor(e/1e6)+"M":e>9999?Math.floor(e/1e3)+"K":e>0?e.toString():""}function wt(e,t){return{search:{name:pe("mail_im_peer_search"),icon:"search"},block_community:{icon:"block",name:pe("mail_block_comm_messages")},block_notify:{icon:"block",name:pe("mail_block_notify_messages")},allow_community:{icon:"unblock",name:pe("mail_allow_comm_messages")},clear:{name:e.peer<-2e9?pe("mail_im_delete_email_contact"):pe("mail_im_delete_all_history"),icon:"clear"},chat:{name:pe("mail_im_create_chat_with"),icon:"invite"},mute:{name:pe("mail_im_mute"),icon:"mute"},unmute:{name:pe("mail_im_unmute"),icon:"unmute"},photos:{name:e.gid?pe("mail_im_show_media_history_group"):pe("mail_im_show_media_history"),icon:"media"},avatar:{icon:"avatar",name:pe("mail_update_photo_red")},block:{icon:"block",name:pe("mail_block_user")},invite:{icon:"invite",name:pe("mail_im_create_chat_with")},invite_link:{icon:"invite-link",name:pe(t?"mail_vkcomgroup_invite_link":"mail_chat_invite_link")},leave:{icon:"leave",name:pe(t?"mail_leave_channel":"mail_leave_chat")},topic:{icon:"topic",name:pe("mail_change_topic")},return:{icon:"return",name:pe(t?"mail_return_to_vkcomgroup":"mail_return_to_chat")},pin_hide:{icon:"pin_hide",name:pe("mail_menu_pin_hide")},pin_unhide:{icon:"pin_unhide",name:pe("mail_menu_pin_show")},unpin:{icon:"unpin",name:pe("mail_menu_unpin")},settings:{icon:"settings",name:pe(t?"mail_vkcomgroup_settings":"mail_settings")}}}function It(e,t){var n=`<img src="${e}" alt="" class="dialogs_inline_chatter dialogs_inline_chatter_half"/>`;return t&&(n=he("im_dialogs_link",{href:t,photo:n})),`<div class="im_grid">\n    <div class="dialogs_inline_chatter dialogs_inline_chatter_half">\n      ${n}\n    </div>\n  </div>`}function xt(e,t){var n=`<img src="${e}" alt="" class="dialogs_inline_chatter"/>`;return t&&(n=he("im_dialogs_link",{href:t,photo:n})),`<div class="im_grid">\n    <div class="dialogs_inline_chatter">\n      ${n}\n    </div>\n  </div>`}function Pt(e,t=[]){if("string"==typeof e)return`<div class="im_grid"><img src="${e}" alt=""/></div>`;switch(e.length){case 1:return`<div class="im_grid"><img src="${e[0]}" alt=""/></div>`;case 2:return e.map((e,n)=>It(e,t[n])).join("");case 3:return It(e[0],t[0])+e.slice(1).map((e,n)=>xt(e,t[n+1])).join("");case 4:return e.map((e,n)=>xt(e,t[n])).join("")}}function Dt(e,t,n){if("string"==typeof t.photo&&t.photo)return`<div class="im_grid"><img src="${t.photo}" alt=""></div>`;if(Object(u.b)(t.peerId)&&t.membersCount<2)return`<div class="im_grid"><img src="${e.get().default_chat_photo}" alt=""></div>`;if(Array.isArray(t.photo))return Pt(t.photo);var r=t.data.active.slice(0,4).map(_.c.bind(null,e));return Pt(r.map(e=>e.photo),n?[]:r.map(e=>e.link))}function $t(e){var t=e.get().gid?pe("mail_search_only_messages_comm"):pe("mail_search_only_messages");return`<li class="im-page--mess-search-w">\n    <div class="im-page--mess-search ${F}">\n      <button type="button" class="im-i--messages-search"></button>${t}\n    </div>\n  </li>`}function Tt(){return`<li class="im-search-results-head">${pe("mail_search_messages")}</li>`}function qt(){return`<li class="im-search-results-head">${pe("mail_search_conversations_sep")}</li>`}function St(){return`<li class="im-search-results-head">${pe("mail_search_dialogs_sep")}</li>`}function Et(){return`<li class="im-search-results-head _im_recent_bar">\n    ${pe("mail_recent_searches")}\n    <button type="button" class="${B} im-page--clear-recent">${pe("mail_clear_recent")}</button>\n  </li>`}function At(e){var t=e.get().popular_sugg,n=Object(c.A)(e)?8:5;return t.length>n&&(t=t.slice(0,n)),'<li class="im-popular clear_fix">'+t.map(t=>{var n=t.peerId,r=Object(_.c)(e,n)||t,a=e.get().tabs[n]||t,i=(e.get().mutedPeers||[]).indexOf(n)>=0;return`<div class="${["im-popular--item","fl_l","_im_dialog","_dont_add_recent","_im_sugg_"+n,a.unread>0&&"sugg-is_unread",i&&"sugg-is_muted"].filter(e=>!!e).join(" ")}" data-peer="${n}">\n    <a class="im-popular--avatar-w ${Se(a.online)}" href="${r.link}"><img class="im-popular--avatar" src="${r.photo}"/></a>\n    <div class="im-popular--name-w"><a class="im-popular--name" href="${r.link}">${r.first_name||r.name}</a></div>\n    <span class="im-popular--unread _sugg_unread_ct">${Ot(a.unread)}</span>\n</div>`}).join("")+"</li>"}function Ct(e,t,n){var r=oe("_im_mess_"+t.messageId,n);if(r){me(r,"aria-hidden","false"),ue(r,`im-mess_failed ${k}`);var a=oe("_im_mess_marker",r);me(a,"aria-label",pe("mail_send_message_error")),me(a,"role","link")}return n}function zt(e,t,n){var r=oe("_im_mess_"+t,n);if(r){de(r,"im-mess_failed"),me(r,"aria-hidden","true"),de(r,k);var a=oe("_im_mess_marker",r);me(a,"aria-label",""),me(a,"role","")}return n}function Mt(e,t){return Nt(e.map(e=>oe("_im_mess_"+e,t)).filter(e=>e),t)}function Nt(e,t){var n=e.filter(e=>!fe(e,"im-mess_srv")).map(e=>e.parentNode);return e.forEach(e=>{fe(e,"im-mess_srv")?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e)}),n.filter(e=>0===re(e).length).map(e=>se("_im_mess_stack",e)).forEach(e=>{fe(te(e),"_im_bar_date")&&J(te(e)),fe(te(e),"_im_unread_bar_row")&&J(te(e)),J(e)}),t}function Ht(e){for(var t=e;t;){var n=t;if(null===(t=t.previousElementSibling)){fe(n,"mess_srv")&&(t=n.parentNode);var r=se("_im_mess_stack",n);r&&(t=r.previousElementSibling,1===re(n.parentNode).length&&r.parentNode.removeChild(r))}fe(n,"_im_unread_bar_row")||n.parentNode.removeChild(n)}}function Bt(e,t,n,r){return e.map(e=>oe("_im_mess_"+e,r)).filter(e=>e).forEach(e=>{_e(e,function(e,t,n){var r=t.innerHTML;return`<div class="im-mess--text">\n    ${pe("delete"===n?"mail_deleted_stop":"mail_marked_as_spam")} <button type="button" data-peer="${e}" class="${w} im-mess--btn">${pe("mail_restore")}</button>\n    <div class="${O} im-mess--original">${r}</div>\n  </div>`}(t,e,n)),ue(e,"im-mess_light")}),r}function Lt(e,t,n){var r=oe("_im_mess_"+e,n);if(r){var a=oe(O,r);_e(r,a.innerHTML),de(r,"im-mess_light")}return n}function Ft(e={},t,n,r,a=2,i=!1){if(i)return Ut(e,t,n,r,!0,a);var c=Ut(e,t,n,r,!1,a);return c.length>60?Ut(e,t,n,r,!0,a):c}function Rt(e){var t={[d.d]:1,[d.c]:2},n=Object.keys(e).sort((e,n)=>t[n]-t[e]),r={},a=n.reduce((t,n)=>{var{userIds:a=[]}=e[n]||{};return a.forEach(e=>{r[e]||(r[e]=!0,t[n]=!0)}),t},{}),i=n.filter(e=>!!a[e]);return i.length>1?"":i[0]}function Ut(e,t,n,r,a,i){var o=function(e,t,n){var r=[],a={};return Object.keys(t).map(n=>{((t[n]||{}).userIds||[]).forEach(t=>{Object(_.b)(e,t)?parseInt(t,10)!==e.id&&(a[t]=n):r.push(t)})}),r.length&&Object(d.hb)({[n]:r},e),Object.keys(a).sort((e,n)=>t[a[e]].ts-t[a[n]].ts)}(r,e,t);if(0===o.length)return"";var s=Object(u.d)(t)||Object(c.D)(t)?"first_name":a?"short_name":"name",l=Rt(e),f="";l===d.c?f=pe("mail_recording_audio_several",o.length):l===d.d&&(f=pe("mail_typing_several",o.length));var m=o.slice(0,Math.min(o.length-1,i)),b=m.map(e=>Object(_.c)(r,e)[s]).join(", ");if(o.length>i+1){var h=function(e){var t={};return Object.keys(e).forEach(n=>{var{userIds:r=[]}=e[n];r.forEach(e=>{t[e]=1})}),Object.keys(t).length}(e);b+=" "+pe("mail_and_peer").replace("{count}",h-i).replace("{typing}",f)}else{if(o.length>1&&(b+=` ${pe("mail_and_peer_one")}`),!Object(u.b)(t)&&n)b+=` ${f}`;else b+=` ${Object(_.c)(r,o[m.length])[s]} ${f}`}return b.trim()}function Kt(){return`<div class="im-page--chat-search-empty">\n    ${pe("mail_im_search_empty")}\n  </div>`}function Xt(e,t,n,r=""){return n?`<a class="im_srv_lnk ${r}" target="_blank" rel="noopener" href="${e}">${t}</a>`:`<span class="${r}">${t}</span>`}function Jt(e,t,n,r=!0){var a=t.kludges,i=a.source_act,c=Z(a.source_mid),o=t.userId,s=Object(_.c)(e,o),u="",d=o===c;switch(i){case x:u="mail_im_chat_created";break;case P:u=a.source_is_channel?"mail_im_title_updated_channel":"mail_im_title_updated_dot";break;case D:u=d?"mail_im_returned_to_chat":"mail_im_invited";break;case $:u=d?"mail_im_left":"mail_im_kicked_from_chat";break;case T:u="mail_im_photo_set";break;case q:u=a.source_is_channel?"mail_im_photo_removed_channel":"mail_im_photo_removed";break;case S:u=a.source_message?"mail_im_pin_message":"mail_im_pin_message_empty2";break;case E:u=a.source_message?"mail_im_unpin_message":"mail_im_unpin_message_empty2";break;case A:u="mail_im_invite_by_link";break;default:return"mail_no_support"}if(u=(u=ge(s.sex,pe(u,"raw"))).replace("{from}",Xt(s.link,s.name,r)),c&&c!==o){var l=a.source_email;if(l)u=u.replace("{user}",Xt(`/im?email=${encodeURIComponent(l)}`,"email",r));else{var f=Object(_.c)(e,c),m=i===$?f.inv_name:f.kick_name;u=u.replace("{user}",Xt(f.link,m,r))}}if(a.source_text){var b=a.source_old_text?`«<b class="im_srv_lnk">${a.source_old_text}</b>» &rarr; `:"";u=u.replace("{title}",b+`«<b class="im_srv_lnk">${a.source_text}</b>»`)}if(a.source_act===S||a.source_act===E)if(a.source_message){var h=Xt("",Qt(Ae.emojiToHTML(Y(a.source_message.replace(/<br\s?\/?>/gi," ")),!0)),!1,"im_srv_mess_link");u=u.replace("{msg}",h)}else u=u.replace(/{link}(.+){\/link}/i,(e,t)=>Xt("",t,!1,"im_srv_mess_link"));return u}function Vt(e,t,n,r){if(t===T){var a=oe("_im_mess_"+e.messageId,r);if(a){n.tabs[e.peerId];a.parentNode.innerHTML=he("im_msg_row",{msg_id:e.messageId,from_id:e.peerId,text:Jt(n,e)+n.chat_photo_msg,ts:e.date,cls:"im-mess_srv"})}}return r}function Qt(e){return e.replace(/&lt;&lt;/g,"&laquo;").replace(/&gt;&gt;/g,"&raquo;").replace(/ \-\-/g," &mdash;").replace(/\-\- /g,"&mdash; ").replace(a.r,"$1$4")}function Gt(e,t){return!t&&e===U.id}function Zt(e,t){return Te(e,{url:Object(c.D)(t)?"al_groups.php":"al_profile.php",params:{act:"verified_tt",mid:t,gid:t},slide:15,ajxdt:200,showdt:200,hidedt:200,dir:"auto",shift:[94,7,7],className:"verified_tt"})}function Wt(e){return(t,n="bottom",r="")=>{var a=X(he("im_preloader",{preloader:V(U.pr_tpl,{id:""}),cls:["bottom"===n?"im-preloader_bottom":"im-preloader_top",r].join(" ")})),i=!1;function c(){i=!0,de(a,"im-preloader_visible"),a.parentNode&&a.parentNode.removeChild(a)}setTimeout(()=>{i||("bottom"===n?e.appendChild(a):e.insertBefore(a,ee(e)),ue(a,"im-preloader_visible"))},0),t.then(c).catch(e=>{Object(g.a)("wrapLoading",e),c()})}}function Yt(e,t){return{0:{msgs:e.reduce((e,t)=>(e[t]=[t,r.l,0,0,"",{},{},0,0,0],e),{}),hash:t,history:1}}}function en(e,t){if(!t&&!e)return!1;var n=e.target||e.srcElement,r=Be,a=!1,i=/_im_mess|im_log_act|im_log_ract|_im_log_body|im_log_rspacer|_im_graffiti_w|_wall_post_cont/;do{if(!n||n.onclick||n.onmousedown||"A"==n.tagName||fe(n,"_im_no_select")||fe(n,"im_msg_media_link")||"IMG"==n.tagName&&!fe(n,"_im_graffiti")&&!fe(n,"emoji")&&!fe(n,"emoji_css")&&!fe(n,"im_gift")||"TEXTAREA"==n.tagName||fe(n,"play_new")||fe(n,"videoplayer")||(a=i.test(n.className)))break}while(r--&&(n=n.parentNode));return!a||!!W((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||"").toString())}function tn(e,t){return`<div class="im-mess--text">\n      <span>${pe("mail_restored")}</span>\n      <a class="_im_go_to" href="/im?sel=${yt(e)}&msgid=${t}">${pe("mail_im_goto_conversation")}</a>\n    </div>`}function nn(e,t,n){var r=pe("mail_deleteall1"),a=pe("mail_sure_to_delete_all"),i=pe("mail_delete");return Object(u.b)(t)&&(Object(v.m)(e,1024)?(r=pe("mail_leave_channel"),a=pe("mail_unfollow_channel_confirmation"),i=pe("mail_unfollow_channel")):a=pe("mail_chat_sure_to_delete_all")),Object(c.D)(t)&&(a=pe("mail_group_sure_to_delete_all")),De(r,a,i,n,pe("global_cancel"))}function rn(e,t,n){var r=Object(c.u)(e,t),a=Object(u.b)(t),i=a&&Object(v.m)(r,1024),o=pe("mail_deleteall1"),s=pe("mail_sure_to_delete_all"),d=pe("mail_delete");if(a){if(r.data.closed||r.data.kicked)return nn(r,t,n.bind(null,!0));i?(o=pe("mail_leave_channel"),s=pe("mail_vkcomgroup_leave_confirm"),d=pe("mail_leave_channel")):(o=pe("mail_leave_chat"),s=pe("mail_chat_leave_confirm"),d=pe("mail_leave_chat"))}Object(c.D)(t)&&(s=pe("mail_group_sure_to_delete_all"));var l=new MessageBox({title:o,width:i?450:500}).content(s).setButtons(d,()=>n(!!isChecked(oe("_check_is_delete"))||!a),pe("global_cancel")).show();return a&&!i&&l.setControlsText(`<div class="checkbox im-delete-forall-checkbox _check_is_delete" onclick="checkbox(this);" role="checkbox" aria-checked="false">${pe("mail_deleteall1")}</div>`),l}function an(e){return De(pe("mail_unpin_title"),pe("mail_unpin_text"),pe("mail_unpin"),e,pe("global_cancel"))}function cn(e,t,n,r){var a=pe("mail_dialog_msg_delete_N",t),i=De(pe("mail_dialog_msg_delete_title"),a,pe("mail_delete"),()=>r(isChecked(oe("_check_forall"))),pe("global_cancel")),c="",o=!1;return n&&(c=`<div class="checkbox im-delete-forall-checkbox _check_forall" onclick="checkbox(this);" role="checkbox" aria-checked="false">${pe("mail_delete_for_all")}</div>`,o=cur.imDb.selectByKey("del_forall_checked")),i.setControlsText(c),o&&checkbox(oe("_check_forall")),i}function on(e,t,n,r,a){t.showProgress(),e.set(r.bind(null,a)).then(()=>{t.hideProgress(),t.hide(),n().removePeer(e,a),n().updateDialogFilters(e)})}function sn(e,t,n,r){var a=e.get().tabs[t].memberIds;e.set(r.bind(null,"add_member",a)).then(n().showCreation)}function un(e,t,n){var r=e.get();if(r.active_tab===a.h&&0===r.dialog_tab_cts.mr)return!1;var i=r.active_tab===a.k?a.h:a.k;return e.set(n.bind(null,i)).then(e=>{t().restoreDialogs(e,!0)})}function dn(e,t,n){if(e.get().active_tab===a.h&&0===e.get().unread_cnt)return!1;var r=e.get().active_tab===a.m?a.h:a.m;return e.set(n.bind(null,r)).then(e=>{t().restoreDialogs(e,!0)})}function ln(e,t,n,r){if(t.get().active_tab===e)return Promise.resolve(t);var a=Object(c.L)(t);return t.set(r.bind(null,e)).then(e=>(n().restoreDialogs(e,!0,a!==Object(c.L)(e)),e))}function fn(e,t){void 0===t&&(t=e.get().peer);var n=e.get().tabs[t];return a.j[a.i]&n.folders}function mn(e,t,n=!1){if(void 0===t&&(t=e.get().peer),!Object(c.E)(e))return!1;var r=n||e.get().tabs[t];return a.j[a.n]&r.folders}function bn(e,t){return!1===((t.get().block_states||{})[e]||{}).free}function _n(e){return null!=e.get().pendingForward}function hn(e,t){return(t.get().block_states[e]||{}).who===U.id}function pn(e,t){var n=e.get().block_states;Object.keys(n).forEach(a=>{n[a].time?!1===n[a].free&&Date.now()-n[a].time>=5e4&&t.push([r.sb([,1,"gim"+e.get().gid,a,0,""])]):n[a].time=Date.now()})}function gn(e,t,n){var r;return!$e("al_im.php",{act:"a_spam",offset:"0",gid:e.get().gid},{onDone:(n,a)=>{a&&(r=t(n,e,a))},params:{width:638,onHide:()=>{Ee.loaded&&Ee.detachPlayer(!0),r.unmount()}}},n)}function vn(e,t){return jn(e.get(),t,Object(c.u)(e,t).last_seen)}function jn(e,t,n,r){if(n[0])return pe("mail_header_online_status")+(qe[n[0]]?yn(t,!1,!1,!0):"");if(!n[1])return"";var a=ye(n[1],e.timeshift),i=ge(Object(_.c)(e,t).sex,pe("mail_last_activity_tip","raw")).replace("{user}","").replace("{time}",a);return n[2]&&(i+=yn(t,!1,!1,r)),i}function yn(e,t,n,r){var a={mid:e};n||(a.was=1),t?a.forcetoup=!0:a.forcetodown=!0,a=Object.assign(a,r);var i=JSON.stringify(a).slice(1,-1).replace(/"/g,"&quot;");return he("im_wrap_mobile",{class:"im_status_mob_onl",params:i})}function kn(e,t){var n=t.get().tabs[e];return Pe("al_settings.php",{act:"blacklist_box",q:n.href},{stat:["settings.js","settings.css"],dark:1})}function On(e,t){return Pe("groupsedit.php",{act:"bl_edit",name:"/id"+e,gid:t.get().gid},{stat:["page.css","ui_controls.js","ui_controls.css"],dark:1})}function wn(e){return e.get().gid?"/gim"+e.get().gid:"/im"}function In(e,t,n,r){var a;Fn($e("al_im.php",{act:"a_important",offset:"0"},{onDone:(r,i)=>{i&&(a=n(r,e,t,i))},params:{width:638,onHide:()=>{Ee.loaded&&Ee.detachPlayer(!0)},onDestroy:()=>{a&&a.unmount()}}},r),e)}function xn(){var e=document.activeElement;return null!==e&&("INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.getAttribute("contenteditable"))}function Pn(e,t,n){var r=oe("_im_mess_"+e,n);return r&&le(r,"im-mess_fav",t),n}function Dn(e,t,n){var r=oe("_im_unread_bar_row",t);if(!r)return t;var a=ae(r,"._im_mess_stack",-1),i=ae(r,"._im_mess_stack"),o=a?ce("_im_mess",a).pop():null,s=i?oe("_im_mess",i):null;if(J(r),function(e){var t=oe("_im_invisible_bar",e);t&&(de(t,"_im_invisible_bar"),de(t,"im-page--history-new-bar_hide"))}(t),!s||!o)return t;var u=ie(s,"msgid"),d=Object(c.r)(e,n,u),l=Object(c.n)(e,n,u);if(!d||gt(e.tabs[n],d,l,e))return t;var f=oe("_im_stack_messages",a),m=oe("_im_stack_messages",i).children;return Object(b.p)(m).forEach(e=>{J(e),f.appendChild(e)}),J(i),t}function $n(e,t,n){var r=Object(c.i)(e,e.get().peer);if(!r)return[!1,0];var a=oe(`_im_mess_${r}`,t);if(!a){var i=Object(c.l)(e,e.get().peer,r);if(!i)return[!0,0];a=oe(`_im_mess_${i.messageId}`,t)}var o=fe(a,"_im_mess_srv")?a:se("_im_mess_stack",a);if(!o)return[!0,0];var s=a?a.offsetTop:0,u=o.offsetTop+s,d=n.contHeight();return u<=n.scrollTop()+n.getScrollHeight()?[!0,0]:[!1,Math.max(0,d-u)]}function Tn(e,t,n){Me(t);var r=se("_im_top_notice",n);ze(r,200,J.pbind(r));var a=se("_im_page_dialogs",r);a&&fe(a,"im-page--dialogs-notice")&&de(a,"im-page--dialogs-notice"),xe.post("al_im.php",{act:"a_hide_top_notice",type:r.getAttribute("data-type"),hash:r.getAttribute("data-hash")})}function qn(e,t,n){Me(t);var r=se("_im_aside_notice",n);Ce(r,200,J.pbind(r)),xe.post("al_im.php",{act:"a_hide_top_notice",type:r.getAttribute("data-type"),hash:r.getAttribute("data-hash")})}function Sn(e,t){Me(e);var n=se("_im_aside_promo_block",t);Ce(n,200,J.pbind(n)),xe.post("al_im.php",{act:"a_hide_promo_block",type:n.getAttribute("data-type"),hash:n.getAttribute("data-hash")})}function En(e,t){se("_im_aside_promo_block",t).classList.add("--action-called"),xe.post("al_im.php",{act:"a_vkadmin_app_install",hash:ie(t,"hash"),platform:ie(t,"platform")})}function An(e,t,n,r,a){return n=n.replace(/\<br\s*\/?\>(\n)?/gi," ").replace(/[\n\r]/gi," "),n=Object(s.f)(n,(e,t,n,r,a)=>a),r&&(n=Ae.emojiToHTML(n,!0)),t&&"..."!==t.trim()&&!Object(u.b)(e)&&(n=he("im_topic",{topic:t,cls:"im-topic_dialog"})+n),!n&&a.length>0&&(n=he("im_dialog_media",{name:Cn(a[0],a)})),n}function Cn(e,t){var n={photo:pe("mail_added_photos","raw"),video:pe("mail_added_videos","raw"),audio:pe("mail_added_audios","raw")};switch(e.type){case"mail":case"respond":var r=e.object?e.object.fwd_count:e.id.split(";").length;return je(r,pe("mail_fwd_msgs","raw"),!0);case"photo":case"video":case"audio":var a=t.filter(t=>t.type===e.type).length;return je(a,n[e.type],!0);case"audio_playlist":return"audio_album"===e.kind?pe("mail_added_audio_album"):pe("mail_added_audio_playlist");case"artist":return pe("mail_added_artist");case"doc":switch(e.kind){case"graffiti":return pe("mail_added_graffiti");case"audiomsg":return pe("mail_added_audiomsg");default:return pe("mail_added_docs")}case"geo":case"map":return pe("mail_added_geo");case"wall":return pe("mail_added_wall");case"wall_reply":return pe("mail_added_wall_reply");case"gift":return pe("mail_added_gift");case"link":case"share":return pe("mail_added_link");case"sticker":return pe("mail_added_sticker");case"market":return pe("mail_added_market_item");case"money_transfer":return pe("mail_added_money_transfer");case"money_request":return pe("mail_added_money_request");case"story":return pe("mail_added_story");case"mask":return pe("mail_added_mask");case"article":return pe("mail_added_article");case"call":return pe("mail_added_call");case"poll":return pe("mail_added_poll");case"podcast":return pe("mail_added_podcast");default:return pe("mail_added_"+e.type)}return""}function zn(e){ue(e,"im-send-btn_loading")}function Mn(e){de(e,"im-send-btn_loading")}function Nn(e){var t=e.get(),n=Object(c.q)(e);if(!n||!Object(h.a)(e,Object(c.p)(e)))return"";var r=Object(_.c)(e,n.userId);if(!r)return"";var a=function(e,t){var n="";if(t&&Object(o.j)(t)&&void 0!==t.kludges.attach1_tr_amount){var r="%s "+t.kludges.attach1_currency;if("RUB"===t.kludges.attach1_currency&&(r=pe("mail_money_amount_rub","raw")),t.kludges.attach1_total_amount){var a=je(t.kludges.attach1_tr_amount/1e3,"%s",!0),i=je(t.kludges.attach1_total_amount/1e3,r,!0);n=pe("mail_money_request_collected_amount_from").replace("{amount}",a).replace("{total_amount}",i)}else{var c=je(t.kludges.attach1_tr_amount/1e3,r,!0);n=pe("mail_money_request_collected_amount").replace("{amount}",c)}if(Z(t.kludges.attach1_held_amount)){var s=je(t.kludges.attach1_held_amount/1e3,r,!0);n+=" "+pe("mail_money_request_held_amount").replace("{amount}",s)}t.text&&(n+='<span class="divider"></span>'+jt(e,t.text,t.kludges)),t.kludges.attach1_total_amount&&(n+=he("im_pinned_message_media_bar",{percent:Math.min(100,Math.floor(t.kludges.attach1_tr_amount/t.kludges.attach1_total_amount*100))}))}return n}(e,n);return a||(a=!(a=n.text)&&n.attaches.length?he("im_pinned_message_media",{text:Cn(n.attaches[0],n.attaches)}):jt(e,a,n&&n.kludges||{})||""),a=a.replace(/<br\s?\/?>/gi," "),he("im_pinned_message",{date:ke(n.date,t.timeshift),content:a,link:r.link,name:r.name})}function Hn(e,t,n){var r=n.getAttribute("data-info");r&&Te(n,{text:r,className:"_im_history_tooltip",appendParentCls:"_im_mess_stack",black:1,hidedt:1e3,shift:[0,4]})}function Bn(e,t,n){var r=+n.getAttribute("data-time");r&&Te(n,{text:pe("mail_message_edited")+" "+ke(r,e.get().timeshift),className:"_im_history_tooltip",appendParentCls:"_im_mess_stack",black:1,shift:[0,4]})}function Ln(){var e=getSize(oe(R))[1];return e||(e=Le),e}function Fn(e,t){e.bodyNode.addEventListener("mouseover",e=>{fe(e.target,"_im_edit_time")?Bn(t,0,e.target):fe(e.target,"_im_page_info")&&Hn(0,0,e.target)})}function Rn(e,t,n,r,a){var i,c=e.get();Fn($e("al_im.php",{act:"a_get_pinned_message_box",chat:n,gid:e.get().gid,hash:c.tabs[n].hash},{onDone:(n,a)=>{a&&(i=r(n,e,t,a))},params:{width:638,onHide:()=>{Ee.loaded&&Ee.detachPlayer(!0)},onDestroy:()=>{i&&i.unmount()}}},a),e)}function Un(e,t,n){var r=e.get();Fn($e("al_im.php",{act:"a_get_replied_message_box",chat:r.peer,msgid:t,gid:r.gid,hash:r.tabs[r.peer].hash},{onDone:(e,t)=>{},params:{width:638,onHide:()=>{Ee.loaded&&Ee.detachPlayer(!0)},onDestroy:()=>{}}},n),e)}function Kn(e,t){return!(!Object(u.b)(e.peerId)||!e.memberIds)&&e.memberIds.indexOf(t)>=0}function Xn(e){return!Object(u.b)(e.peerId)||e.data.kicked?0:e.membersCount}function Jn(e,t){var n=Object(_.c)(e,t.peerId),r=Object(c.u)(e,t.peerId)||{};return n&&(t.photo=t.photo||n.photo,t.name=t.name||n.name,t.href=t.link||n.link,t.sex=t.sex||n.sex),t.last_touched=r.last_touched||0,t.verified=!!t.verified,t.lastmsg=t.lastmsg||t.lastmsg_meta&&t.lastmsg_meta[0]||!1,t.folders=t.folders||null,t.unread=t.unread||0,t.last_seen=t.last_seen||[0,0,0],t.online=t.last_seen&&t.last_seen[0]||0,t.out_up_to=null!=t.out_up_to?t.out_up_to:t.in_up_to||0,Object(u.b)(t.peerId)&&(t.memberIds=t.memberIds||r.memberIds||null),t}function Vn(e,t){for(var n in t)t.hasOwnProperty(n)&&Jn(e,t[n])}function Qn(e,t){var n=[],r=t.find(e=>"mail"===e[0]),a=r?r[1].split(";"):[];for(a.length>He&&(r[1]=a.slice(0,He).join(";"));e.length>Ne;){var i=e.substr(0,Ne).lastIndexOf(" ");-1==i&&(i=Ne),n.push({msgText:W(e.substr(0,i))}),e=W(e.substr(i))}for(e.length&&n.push({msgText:e,attaches:t}),n.length||n.push({attaches:t}),a=a.slice(He);a.length;a=a.slice(He))n.push({attaches:[["mail",a.slice(0,He).join(";")]]});return n}function Gn(e){return e.length>Ne}function Zn(e,t,n){var r=!1;Pe("al_im.php",{act:"a_chat_preview",chat_id:t.invite_chat_id,hash:t.invite_hash},{stat:["boxes.css"],params:{dark:1,hideButtons:!0,onHide(){e.set(n),r&&r.unmount()}},onFail:e=>(setTimeout(()=>De(pe("global_error"),e),0),!0),onDone(t,n){r=m(t.bodyNode,e)}},{})}function Wn(){De(pe("global_error"),pe("mail_message_wait_until_uploaded"))}function Yn(e,t){var n=Object(c.u)(e,t.peerId)||{};if(!t||!Object(o.k)(t))return!1;if(333==t.peerId)return!1;if(Date.now()/1e3-t.date>86400)return!1;if(Qe(e,t.peerId,t.messageId))return!1;if(Object(u.b)(t.peerId)){if(n.data.kicked||n.data.closed)return!1}else if(n.block_error>0)return!1;return!0}function er(e,t){return t.map(t=>Object(_.c)(e,t))}function tr(e,t){if("number"!=typeof e||0===e)return"";var n,r=e,a=[];if([[31536e3,pe(t?"global_years_accusative":"global_age_years","raw")],[2592e3,pe(t?"global_months_accusative":"global_age_months","raw")],[604800,pe(t?"global_weeks_accusative":"global_age_weeks","raw")],[86400,pe(t?"global_days_accusative":"global_age_days","raw")],[3600,pe(t?"global_hours_accusative":"global_hours","raw")],[60,pe(t?"global_minutes_accusative":"global_minutes","raw")],[1,pe(t?"global_seconds_accusative":"global_age_seconds","raw")]].forEach(([e,t])=>{var n=Math.floor(r/e);r%=e,n>=1&&a.push(je(n,t))}),1===(n=a.length))return a.pop();var i=a.slice(0,n-1).join(", "),c=a.pop();return pe("global_and").replace(/{before}/gi,i).replace(/{after}/gi,c)}function nr(e,t,n,a){a&&!Qe(e,n,a)&&(Object(c.n)(e,n,a)?(e.setState({msgid:a}),Object(i.b)({msgid:a}),t()):e.get().longpoll.push([Object(r.gb)(n,a)]))}function rr(e){var t=oe("im-mess_is_editing");if(!t)return null;var n=e.get().tabs[e.get().peer],r=Object(c.S)(n.msgs[ie(t,"msgid")]);return r&&r.peerId==e.get().peer?r:null}function ar(e,t){if(Object(c.A)(e)){var n=document.getElementById("ui_rmenu_mr");n&&(Object(c.d)(e)?n.classList.remove("unshown"):n.classList.add("unshown"))}else t(e)}function ir(e){var t=Object(b.r)(e),n=Number(t.dialog_tab_cts[a.k]),r=n>0?n:"",i=document.querySelector('._im_right_menu_counter[data-tab="mr"]');i&&(i.innerHTML=r)}},Wu9C:function(e,t,n){"use strict";var r=n("N1NS"),a=n("vT4u");function i(e){return{unmount(){Object(r.c)(e)}}}function c(e,t,n){var{bindMutations:a}=Object(r.b)(i);return a(Object(r.a)({handlers:(e,t)=>{}}))}var o=n("P13b"),s=n("rHUl"),u=n("aong"),d=n("uytb");n.d(t,"a",function(){return m}),n.d(t,"c",function(){return b}),n.d(t,"d",function(){return _}),n.d(t,"e",function(){return h}),n.d(t,"b",function(){return v});var l="_im_pin_hide",f="_im_pinned_message";function m(e,t){if(Object(u.r)(e).searchShown)return!1;var n=Object(s.u)(e,t),r=n&&Object(s.S)(n.pinned);return!!r&&n.pinHideId!=r.chat_local_id}function b(e,t,n,r=!0){var a=Object(s.u)(e,t),i=a&&Object(s.S)(a.pinned);a&&i&&(a.pinHideId=i.chat_local_id,cur.imDb.update(d.a,[a.peerId,a.pinHideId]),p(n,t,e),re(geByClass1("_im_pinned_tt")),r&&window.Notifier&&Notifier.lcSend("pin_hide",{hide:1,peer:t}),statlogsValueEvent("im_pinned_messages","hide"))}function _(e,t,n,r=!0){var a=Object(s.u)(e,t);a&&a.pinHideId&&(delete a.pinHideId,cur.imDb.update(d.a,[a.peerId,void 0]),p(n,t,e),r&&window.Notifier&&Notifier.lcSend("pin_hide",{hide:0,peer:t}),statlogsValueEvent("im_pinned_messages","show"))}function h(e,t,n){var r=p.bind(null,n,t),i=Object(o.zc)(()=>{i.hideProgress(),i.hide(),e.set(a.Oc.bind(null,t)).then(r).then(e=>e.set(a.Nc.bind(null,t))).then(r)})}function p(e,t,n){return e().updateChatTopic(t,n),Object(a.oc)(n.get()),e().updateActions(n),n}function g(e){return{unmount(){Object(r.c)(e)}}}function v(e,t,n){var{bindMutations:a}=Object(r.b)(g),i=function(e,t,n){var r=e.get().peer,a=Object(s.S)(Object(s.u)(e,r).pinned);if(n.target.classList.contains(l))a&&b(e,r,t);else if("A"!==n.target.tagName){var i=a&&a.messageId;i&&!Object(o.gb)(e,r,i)?Object(o.N)(e,t().focusOnMessage,r,i):Object(o.wc)(e,t,r,c,n),statlogsValueEvent("im_pinned_messages","open")}}.bind(null,t,n),u=function(e){showTooltip(e.target,{text:getLang("mail_hide_unpin_hover"),black:1,needLeft:1,shift:[8,4],forcetoup:!0,className:"_im_pinned_tt",appendEl:bodyNode})}.bind(null);return a(Object(r.a)({handlers:(t,n)=>{n(e,"click",f,i),n(e,"mouseover",l,u)}}))}},eTng:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return d});var{intval:r}=window;n("rGqo"),n("Btvt"),n("KKXr");function a(e,t=[]){var[n,r]=e.split("_");return[n,r,t]}var i={};function c(e){if(i[e])return i[e];for(var t=e?e.length:0,n=[],r=[],c="",o=0;o<t;o++){var s=e[o],u=s.charCodeAt(0);u>=48&&u<=57||"_"===s||"-"===s?c+=s:"("!==s&&")"!==s&&":"!==s&&","!==s||(""!==c&&(r.push(c),n.push("id"),c=""),r.push(s),n.push(s))}c.length>0&&(r.push(c),n.push("id"));var[d]=function e(t,n,r=0,i=0){if(i>50)return[[],t.length];for(var c=[],o="";r<t.length;){var s=t[r];if("id"===s)o=n[r];else if(","===s&&o)c.push(a(o)),o="";else if("("===s){var[u,d]=e(t,n,r+1,i+1);r=d,c.push(a(o,u)),o=""}else if(")"===s)return""!==o&&c.push(a(o)),[c,r];r++}return o&&c.push(a(o)),[c,r]}(n,r);return Object.keys(i).length>300&&(i={}),i[e]=d,d}function o(e,t){var n=[];e.fwd_count?n.push({type:"mail",id:-t,object:{fwd_count:e.fwd_count}}):e.fwd&&n.push({type:"mail",id:-t,object:{fwd_count:c(e.fwd).length}});for(var a=1;e["attach"+a+"_type"];++a)"call"===e["attach"+a+"_type"]?n.push({type:e["attach"+a+"_type"],id:e["attach"+a],initiatorId:r(e["attach"+a+"_call_initiator_id"]),state:e["attach"+a+"_call_state"],duration:r(e["attach"+a+"_call_duration"]),receiverId:r(e["attach"+a+"_call_receiver_id"])}):n.push({type:e["attach"+a+"_type"],id:e["attach"+a],kind:e["attach"+a+"_kind"],productId:e["attach"+a+"_product_id"]});return e.geo&&n.push({type:"geo",id:e.geo}),n}function s(e){return 0==e}function u(e){return e>0&&e<2e9}function d(e){return e>2e9}},f01n:function(e,t,n){"use strict";n.d(t,"Y",function(){return i}),n.d(t,"Q",function(){return c}),n.d(t,"U",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"J",function(){return u}),n.d(t,"K",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"r",function(){return f}),n.d(t,"d",function(){return m}),n.d(t,"e",function(){return b}),n.d(t,"ab",function(){return _}),n.d(t,"N",function(){return h}),n.d(t,"cb",function(){return p}),n.d(t,"bb",function(){return g}),n.d(t,"I",function(){return v}),n.d(t,"h",function(){return j}),n.d(t,"T",function(){return y}),n.d(t,"P",function(){return k}),n.d(t,"X",function(){return O}),n.d(t,"W",function(){return w}),n.d(t,"O",function(){return I}),n.d(t,"Z",function(){return x}),n.d(t,"V",function(){return P}),n.d(t,"H",function(){return D}),n.d(t,"b",function(){return $}),n.d(t,"c",function(){return T}),n.d(t,"i",function(){return q}),n.d(t,"S",function(){return S}),n.d(t,"f",function(){return E}),n.d(t,"g",function(){return A}),n.d(t,"R",function(){return C}),n.d(t,"db",function(){return M}),n.d(t,"M",function(){return N}),n.d(t,"L",function(){return H}),n.d(t,"m",function(){return B}),n.d(t,"l",function(){return L}),n.d(t,"n",function(){return F}),n.d(t,"j",function(){return R}),n.d(t,"o",function(){return U}),n.d(t,"k",function(){return K}),n.d(t,"q",function(){return X}),n.d(t,"p",function(){return J}),n.d(t,"C",function(){return V}),n.d(t,"v",function(){return Q}),n.d(t,"t",function(){return G}),n.d(t,"y",function(){return Z}),n.d(t,"B",function(){return W}),n.d(t,"D",function(){return Y}),n.d(t,"F",function(){return ee}),n.d(t,"E",function(){return te}),n.d(t,"u",function(){return ne}),n.d(t,"w",function(){return re}),n.d(t,"z",function(){return ae}),n.d(t,"A",function(){return ie}),n.d(t,"x",function(){return ce}),n.d(t,"G",function(){return oe}),n.d(t,"lb",function(){return se}),n.d(t,"Cb",function(){return ue}),n.d(t,"Kb",function(){return de}),n.d(t,"Gb",function(){return le}),n.d(t,"eb",function(){return fe}),n.d(t,"mb",function(){return me}),n.d(t,"Db",function(){return be}),n.d(t,"nb",function(){return _e}),n.d(t,"ub",function(){return he}),n.d(t,"vb",function(){return pe}),n.d(t,"rb",function(){return ge}),n.d(t,"qb",function(){return ve}),n.d(t,"Fb",function(){return je}),n.d(t,"Bb",function(){return ye}),n.d(t,"Jb",function(){return ke}),n.d(t,"kb",function(){return Oe}),n.d(t,"ib",function(){return we}),n.d(t,"jb",function(){return Ie}),n.d(t,"Mb",function(){return xe}),n.d(t,"yb",function(){return Pe}),n.d(t,"Ob",function(){return De}),n.d(t,"Nb",function(){return $e}),n.d(t,"tb",function(){return Te}),n.d(t,"Ab",function(){return qe}),n.d(t,"fb",function(){return Se}),n.d(t,"ob",function(){return Ee}),n.d(t,"Lb",function(){return Ae}),n.d(t,"Ib",function(){return Ce}),n.d(t,"zb",function(){return ze}),n.d(t,"Pb",function(){return Me}),n.d(t,"xb",function(){return Ne}),n.d(t,"wb",function(){return He}),n.d(t,"Hb",function(){return Be}),n.d(t,"gb",function(){return Le}),n.d(t,"hb",function(){return Fe}),n.d(t,"pb",function(){return Re}),n.d(t,"sb",function(){return Ue}),n.d(t,"Eb",function(){return Ke});n("OEbY");var r=n("eTng"),a="event_delete",i="event_set_flags",c="event_replace_flags",o="event_reset_flags",s="event_add_message",u="event_read_inbound",d="event_read_outbound",l="event_got_online",f="event_got_offline",m="event_chat_changed",b="event_chat_updated",_="event_typing",h="event_recoding_audio",p="event_video_call",g="event_unread_count",v="event_notify_settings_changed",j="event_empty",y="event_reset_directories",k="event_replace_directories",O="event_set_directories",w="event_resync",I="event_refresh_lp_key",x="transition_event",P="reset_peer",D="mutex",$="change_peer",T="event_change_tab",q="event_failed_message",S="event_resend",E="event_delete_dialog",A="event_edit_message",C="event_replace_message",z="event_audio_start",M="event_waiting_for_reconnect",N="event_reconnecting",H="event_reconnected",B=2,L=8,F=64,R=128,U=65536,K=1<<21,X=1,J=8,V=1,Q=2,G=3,Z=4,W=5,Y=6,ee=7,te=8,ne=9,re=10,ae=11,ie=12,ce=13,oe=3;function se([,e]){return{type:a,localId:e}}function ue([,e,t,n]){return{type:c,messageId:e,mask:t,peerId:n}}function de([,e,t,n]){return{type:i,messageId:e,flags:t,peerId:n}}function le([,e,t,n]){return{type:o,messageId:e,flags:t,peerId:n}}function fe([,e,t,n,a,i,c,o,u,d,l]){var f=extend(c,o||void 0);return{type:s,messageId:intval(e),flags:intval(t),peerId:intval(n),date:intval(a),attaches:Object(r.a)(f,e),subject:c.title||"",text:i,kludges:f,randomId:intval(u),userId:Object(r.b)(n)?intval(f.from):intval(n),update_time:l,chat_local_id:d}}function me(e){var t=fe(e);return t.type=A,t}function be(e){var t=fe(e);return t.type=C,t}function _e(e){return extend({},e,{type:A})}function he([,e,t,n]){return{type:u,peerId:e,upToId:t,unread:n}}function pe([,e,t,n]){return{type:d,peerId:e,upToId:t,unread:n}}function ge([,e,t,n]){return{type:l,userId:-e,platform:t,lastSeenTs:n}}function ve([,e,t,n]){return{type:f,userId:-e,reason:t,lastSeenTs:n}}function je([,e,t,n=!1]){return{type:y,peerId:e,mask:t,local:n}}function ye([,e,t]){return{type:k,peerId:e,mask:t}}function ke([,e,t,n=!1]){return{type:O,peerId:e,mask:t,local:n}}function Oe([,e,t]){return{type:E,peerId:e,localId:t}}function we([,e,t]){return{type:m,chatId:e,self:t}}function Ie([,e,t,n]){return{type:b,peerId:t,updateType:e,updateArg:n}}function xe([,e,t,n,r]){return{type:_,peerId:e,userIds:t,totalCount:n,ts:r}}function Pe([,e,t,n,r]){return{type:h,peerId:e,userIds:t,totalCount:n,ts:r}}function De([,e,t]){return{type:p,userId:e,callId:t}}function $e([,e,t,n]){return{type:g,count:e,countNotMuted:t,showOnlyNotMuted:n}}function Te([,e={}]){return{type:v,peerId:e.peer_id,sound:e.sound,disabledUntil:e.disabled_until}}function qe([,e={}]){var t=fe([!1,e.id,e.flags,e.peer_id,e.date,e.message,extend(e.kludges,{title:e.title||""}),{},e.random_id,e.chat_local_id,e.update_time]);return t.type=A,t}function Se([,e={}]){return{type:z,uuid:e.uuid,deviceName:e.device_name||""}}function Ee(e){return{type:j,params:e}}function Ae(e){return{type:x,state:e}}function Ce(){return{type:w}}function ze([,e,t]){return{type:I,key:e,url:t}}function Me([,e]){return{type:M,timeout:e}}function Ne(){return{type:N}}function He(){return{type:H}}function Be(e=!1,t=!1){return{type:P,cancelSearch:e,removeActivePeer:t}}function Le(e,t=!1,n=!1,r=!1,a=""){return{type:$,peerId:e,msgid:t,forward:n,cancelSearch:r,entryPoint:a}}function Fe(e){return{type:T,tab:e}}function Re(e,t,n){return{type:q,message:t,peer:e,error:n}}function Ue([e,t,n,r,a,i]){return{type:D,free:!!intval(t)||intval(a)===vk.id,resource:n,peerId:intval(r),who:intval(a),name:i}}function Ke(e,t){return{type:S,message:t,peerId:e}}},"h++7":function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"f",function(){return a}),n.d(t,"B",function(){return i}),n.d(t,"q",function(){return c}),n.d(t,"r",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return u}),n.d(t,"v",function(){return d}),n.d(t,"u",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"o",function(){return m}),n.d(t,"e",function(){return b}),n.d(t,"z",function(){return _}),n.d(t,"A",function(){return h}),n.d(t,"w",function(){return p}),n.d(t,"m",function(){return g}),n.d(t,"h",function(){return v}),n.d(t,"n",function(){return j}),n.d(t,"i",function(){return y}),n.d(t,"k",function(){return k}),n.d(t,"l",function(){return O}),n.d(t,"g",function(){return w}),n.d(t,"j",function(){return I}),n.d(t,"y",function(){return x}),n.d(t,"p",function(){return P}),n.d(t,"c",function(){return D}),n.d(t,"s",function(){return $}),n.d(t,"x",function(){return q});n("Oyvg");var r=/^([a-zA-Z0-9\.\_\-]+\.)?(vkontakte\.ru|vk\.com|vkadre\.ru|vshtate\.ru|userapi\.com|vk\.me)$/,a=/([^a-zA-Z0-9#%;_\-.\/?&=\[\]])/g,i=/^(?:https?:\/\/)?(?:vk\.com|vkontakte\.ru)?\/([a-zA-Z0-9\._]+)\??$/,c=/\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,o=/(^|[\s.,:\'\";>\)\(])(\*|@)([A-Za-z0-9_\.]{2,32})\s*\((.+?)\)/g,s=38,u=40,d=33,l=34,f=35,m=36,b=13,_=[s,u,d,l,b,27,f,m],h=[d,l,u,s,m,f],p="printable",g="unread",v="all",j="unrespond",y="important",k="mr",O="mr_rejected",w=[v,g,j,y,k],I={[j]:2,[y]:1,[k]:256,[O]:512},x=[].concat("aaa,aarp,abarth,abb,abbott,abbvie,abc,able,abogado,abudhabi,ac,academy,accenture,accountant,accountants,aco,active,actor,ad,adac,ads,adult,ae,aeg,aero,aetna,af,afamilycompany,afl,africa,ag,agakhan,agency,ai,aig,aigo,airbus,airforce,airtel,akdn,al,alfaromeo,alibaba,alipay,allfinanz,allstate,ally,alsace,alstom,am,americanexpress,americanfamily,amex,amfam,amica,amsterdam,an,analytics,android,anquan,anz,ao,aol,apartments,app,apple,aq,aquarelle,ar,aramco,archi,army,arpa,art,arte,as,asda,asia,associates,at,athleta,attorney,au,auction,audi,audible,audio,auspost,author,auto,autos,avianca,aw,aws,ax,axa,az,azure,ba,baby,baidu,banamex,bananarepublic,band,bank,bar,barcelona,barclaycard,barclays,barefoot,bargains,baseball,basketball,bauhaus,bayern,bb,bbc,bbt,bbva,bcg,bcn,bd,be,beats,beauty,beer,bentley,berlin,best,bestbuy,bet,bf,bg,bh,bharti,bi,bible,bid,bike,bing,bingo,bio,biz,bj,bl,black,blackfriday,blanco,blockbuster,blog,bloomberg,blue,bm,bms,bmw,bn,bnl,bnpparibas,bo,boats,boehringer,bofa,bom,bond,boo,book,booking,boots,bosch,bostik,boston,bot,boutique,box,bq,br,bradesco,bridgestone,broadway,broker,brother,brussels,bs,bt,budapest,bugatti,build,builders,business,buy,buzz,bv,bw,by,bz,bzh,ca,cab,cafe,cal,call,calvinklein,cam,camera,camp,cancerresearch,canon,capetown,capital,capitalone,car,caravan,cards,care,career,careers,cars,cartier,casa,case,caseih,cash,casino,cat,catering,catholic,cba,cbn,cbre,cbs,cc,cd,ceb,center,ceo,cern,cf,cfa,cfd,cg,ch,chanel,channel,chase,chat,cheap,chintai,chloe,christmas,chrome,chrysler,church,ci,cipriani,circle,cisco,citadel,citi,citic,city,cityeats,ck,cl,claims,cleaning,click,clinic,clinique,clothing,cloud,club,clubmed,cm,cn,co,coach,codes,coffee,college,cologne,com,comcast,commbank,community,company,compare,computer,comsec,condos,construction,consulting,contact,contractors,cooking,cookingchannel,cool,coop,corsica,country,coupon,coupons,courses,cr,credit,creditcard,creditunion,cricket,crown,crs,cruise,cruises,csc,cu,cuisinella,cv,cw,cx,cy,cymru,cyou,cz,dabur,dad,dance,data,date,dating,datsun,day,dclk,dds,de,deal,dealer,deals,degree,delivery,dell,deloitte,delta,democrat,dental,dentist,desi,design,dev,dhl,diamonds,diet,digital,direct,directory,discount,discover,dish,diy,dj,dk,dm,dnp,do,docs,doctor,dodge,dog,doha,domains,dot,download,drive,dtv,dubai,duck,dunlop,duns,dupont,durban,dvag,dvr,dz,earth,eat,ec,eco,edeka,edu,education,ee,eg,eh,email,emerck,energy,engineer,engineering,enterprises,epost,epson,equipment,er,ericsson,erni,es,esq,estate,esurance,et,eu,eurovision,eus,events,everbank,exchange,expert,exposed,express,extraspace,fage,fail,fairwinds,faith,family,fan,fans,farm,farmers,fashion,fast,fedex,feedback,ferrari,ferrero,fi,fiat,fidelity,fido,film,final,finance,financial,fire,firestone,firmdale,fish,fishing,fit,fitness,fj,fk,flickr,flights,flir,florist,flowers,fly,fm,fo,foo,food,foodnetwork,football,ford,forex,forsale,forum,foundation,fox,fr,free,fresenius,frl,frogans,frontdoor,frontier,ftr,fujitsu,fujixerox,fun,fund,furniture,futbol,fyi,ga,gal,gallery,gallo,gallup,game,games,gap,garden,gb,gbiz,gd,gdn,ge,gea,gent,genting,george,gf,gg,ggee,gh,gi,gift,gifts,gives,giving,gl,glade,glass,gle,global,globo,gm,gmail,gmbh,gmo,gmx,gn,godaddy,gold,goldpoint,golf,goo,goodhands,goodyear,goog,google,gop,got,gov,gp,gq,gr,grainger,graphics,gratis,green,gripe,group,gs,gt,gu,guardian,gucci,guge,guide,guitars,guru,gw,gy,hair,hamburg,hangout,haus,hbo,hdfc,hdfcbank,health,healthcare,help,helsinki,here,hermes,hgtv,hiphop,hisamitsu,hitachi,hiv,hk,hkt,hm,hn,hockey,holdings,holiday,homedepot,homegoods,homes,homesense,honda,honeywell,horse,hospital,host,hosting,hot,hoteles,hotmail,house,how,hr,hsbc,ht,htc,hu,hughes,hyatt,hyundai,ibm,icbc,ice,icu,id,ie,ieee,ifm,ikano,il,im,imamat,imdb,immo,immobilien,in,industries,infiniti,info,ing,ink,institute,insurance,insure,int,intel,international,intuit,investments,io,ipiranga,iq,ir,irish,is,iselect,ismaili,ist,istanbul,it,itau,itv,iveco,iwc,jaguar,java,jcb,jcp,je,jeep,jetzt,jewelry,jio,jlc,jll,jm,jmp,jnj,jo,jobs,joburg,jot,joy,jp,jpmorgan,jprs,juegos,juniper,kaufen,kddi,ke,kerryhotels,kerrylogistics,kerryproperties,kfh,kg,kh,ki,kia,kim,kinder,kindle,kitchen,kiwi,km,kn,koeln,komatsu,kosher,kp,kpmg,kpn,kr,krd,kred,kuokgroup,kw,ky,kyoto,kz,la,lacaixa,ladbrokes,lamborghini,lamer,lancaster,lancia,lancome,land,landrover,lanxess,lasalle,lat,latino,latrobe,law,lawyer,lb,lc,lds,lease,leclerc,lefrak,legal,lego,lexus,lgbt,li,liaison,lidl,life,lifeinsurance,lifestyle,lighting,like,lilly,limited,limo,lincoln,linde,link,lipsy,live,living,lixil,lk,loan,loans,local,locker,locus,loft,lol,london,lotte,lotto,love,lpl,lplfinancial,lr,ls,lt,ltd,ltda,lu,lundbeck,lupin,luxe,luxury,lv,ly,ma,macys,madrid,maif,maison,makeup,man,management,mango,market,marketing,markets,marriott,marshalls,maserati,mattel,mba,mc,mcd,mcdonalds,mckinsey,md,me,med,media,meet,melbourne,meme,memorial,men,menu,meo,metlife,mf,mg,mh,miami,microsoft,mil,mini,mint,mit,mitsubishi,mk,ml,mlb,mls,mm,mma,mn,mo,mobi,mobile,mobily,moda,moe,moi,mom,monash,money,monster,montblanc,mopar,mormon,mortgage,moscow,moto,motorcycles,mov,movie,movistar,mp,mq,mr,ms,msd,mt,mtn,mtpc,mtr,mu,museum,mutual,mv,mw,mx,my,mz,na,nab,nadex,nagoya,name,nationwide,natura,navy,nba,nc,ne,nec,net,netbank,netflix,network,neustar,new,newholland,news,next,nextdirect,nexus,nf,nfl,ng,ngo,nhk,ni,nico,nike,nikon,ninja,nissan,nissay,nl,no,nokia,northwesternmutual,norton,now,nowruz,nowtv,np,nr,nra,nrw,ntt,nu,nyc,nz,obi,observer,off,office,okinawa,olayan,olayangroup,oldnavy,ollo,om,omega,one,ong,onl,online,onyourside,ooo,open,oracle,orange,org,organic,orientexpress,origins,osaka,otsuka,ott,ovh,pa,page,pamperedchef,panasonic,panerai,paris,pars,partners,parts,party,passagens,pay,pccw,pe,pet,pf,pfizer,pg,ph,pharmacy,philips,phone,photo,photography,photos,physio,piaget,pics,pictet,pictures,pid,pin,ping,pink,pioneer,pizza,pk,pl,place,play,playstation,plumbing,plus,pm,pn,pnc,pohl,poker,politie,porn,post,pr,pramerica,praxi,press,prime,pro,prod,productions,prof,progressive,promo,properties,property,protection,pru,prudential,ps,pt,pub,pw,pwc,py,qa,qpon,quebec,quest,qvc,racing,radio,raid,re,read,realestate,realtor,realty,recipes,red,redstone,redumbrella,rehab,reise,reisen,reit,reliance,ren,rent,rentals,repair,report,republican,rest,restaurant,review,reviews,rexroth,rich,richardli,ricoh,rightathome,ril,rio,rip,rmit,ro,rocher,rocks,rodeo,rogers,room,rs,rsvp,ru,ruhr,run,rw,rwe,ryukyu,sa,saarland,safe,safety,sakura,sale,salon,samsclub,samsung,sandvik,sandvikcoromant,sanofi,sap,sapo,sarl,sas,save,saxo,sb,sbi,sbs,sc,sca,scb,schaeffler,schmidt,scholarships,school,schule,schwarz,science,scjohnson,scor,scot,sd,se,seat,secure,security,seek,select,sener,services,ses,seven,sew,sex,sexy,sfr,sg,sh,shangrila,sharp,shaw,shell,shia,shiksha,shoes,shop,shopping,shouji,show,showtime,shriram,si,silk,sina,singles,site,sj,sk,ski,skin,sky,skype,sl,sling,sm,smart,smile,sn,sncf,so,soccer,social,softbank,software,sohu,solar,solutions,song,sony,soy,space,spiegel,spot,spreadbetting,sr,srl,srt,ss,st,stada,staples,star,starhub,statebank,statefarm,statoil,stc,stcgroup,stockholm,storage,store,stream,studio,study,style,su,sucks,supplies,supply,support,surf,surgery,suzuki,sv,swatch,swiftcover,swiss,sx,sy,sydney,symantec,systems,sz,tab,taipei,talk,taobao,target,tatamotors,tatar,tattoo,tax,taxi,tc,tci,td,tdk,team,tech,technology,tel,telecity,telefonica,temasek,tennis,teva,tf,tg,th,thd,theater,theatre,tiaa,tickets,tienda,tiffany,tips,tires,tirol,tj,tjmaxx,tjx,tk,tkmaxx,tl,tm,tmall,tn,to,today,tokyo,tools,top,toray,toshiba,total,tours,town,toyota,toys,tp,tr,trade,trading,training,travel,travelchannel,travelers,travelersinsurance,trust,trv,tt,tube,tui,tunes,tushu,tv,tvs,tw,tz,ua,ubank,ubs,uconnect,ug,uk,um,unicom,university,uno,uol,ups,us,uy,uz,va,vacations,vana,vanguard,vc,ve,vegas,ventures,verisign,vermögensberater,vermögensberatung,versicherung,vet,vg,vi,viajes,video,vig,viking,villas,vin,vip,virgin,visa,vision,vista,vistaprint,viva,vivo,vlaanderen,vn,vodka,volkswagen,volvo,vote,voting,voto,voyage,vu,vuelos,wales,walmart,walter,wang,wanggou,warman,watch,watches,weather,weatherchannel,webcam,weber,website,wed,wedding,weibo,weir,wf,whoswho,wien,wiki,williamhill,win,windows,wine,winners,wme,wolterskluwer,woodside,work,works,world,wow,ws,wtc,wtf,xbox,xerox,xfinity,xihuan,xin,xperia,xxx,xyz,yachts,yahoo,yamaxun,yandex,ye,yodobashi,yoga,yokohama,you,youtube,yt,yu,yun,za,zappos,zara,zero,zip,zippo,zm,zone,zuerich,zw".split(","),"бг,бел,дети,ею,католик,ком,мкд,мон,москва,онлайн,орг,рус,рф,сайт,срб,укр".split(","),"qxam,90ae,90ais,d1acj3b,e1a4c,80aqecdr1a,j1aef,d1alf,l1acc,80adxhks,80asehdb,c1avg,p1acf,p1ai,80aswg,90a3ac,j1amh,80ao21a,y9a3aq,9dbq2a,mgbca7dzdo,mgba3a3ejt,mgbayh7gpa,lgbbat1ad8j,mgberp4a5d4ar,mgba7c0bbn0a,mgbc0a9azcg,mgb2ddes,mgbaam7a8h,mgba3a4f16a,mgbbh1a,mgbab2bd,ngbe9e0a,mgbbh1a71e,pgbs0dh,mgbpl2fh,ogbpf8fl,ngbc5azd,mgbtx2b,mgb9awbf,ygbi2ammx,wgbl6a,mgbi4ecexp,fhbei,wgbh1c,mgbx4cd0ab,mgbb9fbpob,4gbrim,mgbt3dhd,mgbai9azgqp6j,mgbgu82a,11b4c3d,c2br7g,h2brj9c,h2breg3eve,h2brj9c8c,i1b6b1a6a2e,54b7fta0cc,45brj9c,45br5cyl,s9brj9c,gecrj9c,3hcrj9c,xkc2dl3a5ee0h,xkc2al3hye2a,clchc0ea0b2g2a9gcd,fpcrj9c3d,2scrj9c,rvc1e0am3e,fzc2c9e2c,42c2d9a,o3cw4h,node,q9jyb4c,gckr3f0f,qcka1pmc,tckwe,cck2b3b,1ck2e1b,bck1b9a5dre4c,eckvdtc9d,rhqv96g,fiq64b,fiqs8s,fiqz9s,fiq228c5hs,vhquv,1qqw23a,vuq861b,nyqy26a,45q11c,55qx5d,55qw42g,kprw13d,kpry57d,czru2d,czrs0t,czr694b,w4rs40l,w4r85el8fhu5dnra,3ds443g,3oq18vl8pn36a,pssy2u,tiq49xqyj,fjq720a,fct429k,estv75g,xhq521b,9krt00a,30rr7y,6qq986b3xl,kput3i,kpu716f,zfr164b,mxtq1m,yfro4i67o,efvy88h,9et52u,rovu88b,nqv7f,b4w605ferd,unup4y,mix891f,mix082f,3pxu8k,pbt977c,6frz82g,nqv7fs00ema,ses554g,hxt814e,5tzm5g,io0a7i,8y0a063a,jlq61u9w7b,flw351e,g2xx48c,gk3at1e,3bst00m,fzys8d69uvgm,kcrx77d1x4a,jvr189m,imr513n,5su34j936bgsg,j6w193g,t60b56a,mk1bu44c,cg4bki,3e0b707e".split(",").map(e=>"xn--"+e)),P=x.reduce((e,t)=>Math.max(e,t.length),0),D=new RegExp("([a-zA-Zа-яА-Я\\-_\\.0-9\\+]+@(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-z\\$а-яА-Я\\-\\d]{2,22})))","ig"),$=new RegExp("(https?:\\/\\/)?(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-z\\$а-яА-Я\\-\\d]{2,22})(?:\\:(\\d{2,5}))?)(([\\/?#])(?:\\&amp;|\\&#\\d{2,6};|,[_%]|!|,*[\\wА-Яа-я\\xa8\\xb8\\xc0-\\xffєЄҐґЇїІіЈј\\—\\-\\_@#%?+\\/\\$.~=;:'ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ　-〿＀-￯*]+|(?:\\(|\\[)[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\d&#%;,]+(?:\\)|\\])){0,200})?","ig"),T="(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’_\\d]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?))",q=`(^|[s.,:'";>)(]?)(${`(#${T}{0,100}(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?))${T}{0,100})`})(@((?:[a-z0-9_]*[a-z0-9])?(?:(?:.[a-z](?:[a-z0-9_]+[a-z0-9])?)*.[a-z][a-z0-9_]{2,40}[a-z0-9])?))?(?=$|[s.,:'"&;?<)(]?)`},lJdi:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"d",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return u}),n.d(t,"l",function(){return g}),n.d(t,"f",function(){return v}),n.d(t,"e",function(){return j}),n.d(t,"h",function(){return y}),n.d(t,"i",function(){return k}),n.d(t,"j",function(){return O}),n.d(t,"g",function(){return w}),n.d(t,"k",function(){return I}),n.d(t,"m",function(){return P}),n.d(t,"n",function(){return $});n("OEbY");var r=n("rHUl"),a=n("aong"),i=n("P13b"),c=1,o=4,s=8,u=16,d="see_invite_link",l="change_invite_link",f="invite_user",m="pin_unpin",b="change_title",_="add_admin",h={[d]:32,[l]:32,[_]:u,[f]:c,[m]:o,[b]:s},p=1;function g(e,t,n){return x(e,d,t,n)}function v(e,t,n){return x(e,l,t,n)}function j(e,t,n,i){var c=Object(a.r)(e);return!$(Object(r.u)(c,n||c.peer),t)&&x(e,_,n,i)}function y(e,t,n){return x(e,f,t,n)}function k(e,t,n,c){var o=Object(a.r)(e);if(function(e,t){var n=Object(a.r)(e);return void 0!==n.service&&(n.service&t)>0}(e,p))return!0;var s=Object(r.u)(o,n||o.peer);return!(s.data.kicked&&!s.data.closed)&&(!Object(i.rb)(e,n)&&(!$(s,t)&&(!!$(s,c=void 0===c?window.vk.id:c)||(D(s,c)?!D(s,t):function(e,t){return-1!==e.invitedByMe.indexOf(t)}(s,t)&&!D(s,t)))))}function O(e,t,n){return x(e,m,t,n)}function w(e,t,n){return x(e,b,t,n)}function I(e,t,n){return!Object(r.D)(n)||!!Object(r.u)(e,t).caccess[n]}function x(e,t,n,c){var o=Object(a.r)(e);c=void 0===c?window.vk.id:c,n=void 0===n?o.peer:n;var s=Object(r.u)(o,n),u=!s.data.kicked&&!s.data.closed,p=h[t];if(Object(i.rb)(e,n))switch(t){case _:case f:return!1;case d:return u;default:return o.gid>0}switch(t){case d:case l:case _:return P(s,p)?D(s,c)&&u:$(s,c);case f:case m:case b:return P(s,p)?D(s,c)&&u:u}return!1}function P(e,t){return((e&&e.data&&e.data.flags||0)&t)>0}function D(e,t){return(e&&e.adminIds||[]).indexOf(+t)>-1}function $(e,t){return e.ownerId===t}},nyd8:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var{nav:r,extend:a}=window;n("rGqo"),n("Btvt");function i(e){var t=a({},r.objLoc,e);Object.keys(t).filter(e=>""===t[e]).forEach(e=>{delete t[e]});var n=r.toStr(t);r.setLoc(n)}function c(){var e={};return{scheduleNav(t){e=a(e,t)},commitNav(){i(e),e={}},scheduleNavWithTimeOut(t,n=100){e=a(e,t),setTimeout(()=>{i(e),e={}},n)}}}},p3re:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"f",function(){return d}),n.d(t,"d",function(){return m}),n.d(t,"a",function(){return b}),n.d(t,"b",function(){return _});n("SRfc"),n("Oyvg"),n("pIFo");var r,a=n("h++7"),{clean:i,replaceEntities:c,statlogsValueEvent:o}=window;function s(e,t){for(var n,r=0,i=e;null!==(n=a.s.exec(e));){var c=(n=l(n))[0].length,o=n.index+c,s=e[n.index-1],u=e[o-1],d=void 0!==s&&/([\w\$А-Яа-яёЁєЄҐґЇїІіЈј\—\-\_@;.])/i.test(s),m=void 0!==u&&/([:;$])/i.test(u);if(!d&&!m){var b=f(n),_=b.domain.toLowerCase();if(_.length<=a.p&&-1!==a.y.indexOf(_)){var h=t(b);i=i.slice(0,n.index+r)+h+i.slice(o+r),r+=h.length-c}}}return i}function u(e,t){return e.replace(a.c,t||function(e){return`<a href="mailto:${e}">${e}</a>`})}function d(e,t){return e.replace(a.q,t||function(e,t,n,r,a){return`<a href="/${t+n}" class="mem_link" mention="${i(r||"")}" mention_id="${i(t+n)}" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)">${a}</a>`})}function l(e){if(!e[0]||!e[6])return e;var t=e[0].length-1,n=e[6].length-1;return"."===e[0][t]&&"."===e[6][n]&&(e[0]=e[0].slice(0,t),e[6]=e[6].slice(0,n)),e}function f(e){return{full:e[0],protocol:e[1]||"http://",url:e[2],domain:e[4],query:e[6]||""}}function m(e,t){return e.replace((r||(r=new RegExp(a.x,"ig")),r),(e,n,r,a,i,c)=>(n||"")+t(r+(i||"")))}function b(e){o("ttl_message_confirm_delivery",e)}function _(e,t){var{protocol:n,url:r,query:o,domain:s,full:u}=t;try{u=decodeURIComponent(u)}catch(e){}if(u.length>55&&(u=u.substr(0,53)+".."),u=i(u).replace(/&amp;/g,"&"),!e&&s.match(a.t)){var d,l=r=c(r).replace(a.f,encodeURIComponent),f=r.indexOf("#/"),m="";return f>=0?l=r.substr(f+1):(f=r.indexOf("#!"))>=0&&(l="/"+r.substr(f+2).replace(/^\//,"")),(d=l.match(a.B))&&d[1].length<32&&(m=' mention_id="'+d[1]+'" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)"'),'<a href="'+function(e){return e.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(n+r+o)+'" target="_blank" rel="noopener"'+m+">"+u+"</a>"}return`<a href="${`away.php?utf=1&to=${encodeURIComponent(n+c(r+o))}`}" target="_blank" rel="noopener" onclick="${`return goAway('${i((n+r+o).replace(/'/g,"\\'"))}', {}, event);`}">${u}</a>`}},rHUl:function(e,t,n){"use strict";n.d(t,"i",function(){return d}),n.d(t,"N",function(){return l}),n.d(t,"p",function(){return f}),n.d(t,"g",function(){return m}),n.d(t,"k",function(){return b}),n.d(t,"u",function(){return _}),n.d(t,"h",function(){return h}),n.d(t,"t",function(){return p}),n.d(t,"o",function(){return g}),n.d(t,"b",function(){return v}),n.d(t,"M",function(){return j}),n.d(t,"m",function(){return y}),n.d(t,"l",function(){return k}),n.d(t,"S",function(){return O}),n.d(t,"e",function(){return w}),n.d(t,"n",function(){return I}),n.d(t,"r",function(){return x}),n.d(t,"A",function(){return P}),n.d(t,"H",function(){return D}),n.d(t,"E",function(){return $}),n.d(t,"C",function(){return T}),n.d(t,"z",function(){return q}),n.d(t,"f",function(){return S}),n.d(t,"L",function(){return E}),n.d(t,"F",function(){return A}),n.d(t,"R",function(){return C}),n.d(t,"G",function(){return z}),n.d(t,"x",function(){return M}),n.d(t,"Q",function(){return N}),n.d(t,"D",function(){return H}),n.d(t,"B",function(){return B}),n.d(t,"a",function(){return L}),n.d(t,"O",function(){return F}),n.d(t,"s",function(){return R}),n.d(t,"P",function(){return U}),n.d(t,"K",function(){return K}),n.d(t,"q",function(){return X}),n.d(t,"c",function(){return J}),n.d(t,"y",function(){return V}),n.d(t,"j",function(){return Q}),n.d(t,"v",function(){return G}),n.d(t,"w",function(){return Z}),n.d(t,"U",function(){return W}),n.d(t,"T",function(){return Y}),n.d(t,"J",function(){return ee}),n.d(t,"V",function(){return te}),n.d(t,"d",function(){return ne}),n.d(t,"I",function(){return re});n("Vd3H"),n("rGqo"),n("Btvt");var r=n("MhhX"),a=n("f01n"),i=n("h++7"),c=n("86+7"),o=n("rjmT"),s=n("aong"),u=n("lJdi");function d(e,t){var n=Object(s.r)(e),a=n.tabs[n.peer];return Object.keys(a.msgs).filter(n=>{var i=I(e,t,n);return!Object(r.k)(i)&&intval(n)>a.in_up_to})[0]}function l(e){return Object(s.r)(e).searchShown}function f(e){return Object(s.r)(e).peer}function m(e){return b(e,f(e))}function b(e,t){var{keyboard:n}=_(e,t)||{};return n}function _(e,t){var n=Object(s.r)(e);return n.tabs&&n.tabs[t]}function h(e){var t=Object(s.r)(e);return t.peer?t.tabs[t.peer]:null}function p(e){return Object(s.r)(e).selectedMessages}function g(e,t,n){var a=_(e,t),i=p(e)[0];if(void 0===i)return[n];var c=Math.min(n,i),o=Math.max(n,i);return Object.keys(a.msgs).filter(e=>e>=c&&e<=o).filter(t=>{var n=I(e,e.get().peer,t);return!Object(r.l)(n)&&!Object(r.e)(n)}).map(intval)}function v(e,t){var n=_(Object(s.r)(t),e),a=0;for(var i in n.msgs)if(n.msgs.hasOwnProperty(i)){var c=I(t,e,i);Object(r.k)(c)||(a+=Object(r.n)(n,c)?1:0)}return a}function j(e,t,n){return!!function(e,t,n){var r=_(e,t);return Object.keys(r.msgs).filter(r=>intval(I(e,t,r).randomId)===n).length>0}(e,t,n)}function y(e,t){var n=Object(s.r)(e),r=n.msg_local_ids_sort&&n.msg_local_ids_sort[t];return void 0!==r?2e9+r:t}function k(e,t,n){var r=_(e,t),i=I(e,t,n),c=Object.keys(r.msgs).filter(n=>{var r=I(e,t,n),c=r.local&&r.type!==a.g;return!(!i.local&&c)&&(!(!i.local||c)||y(e,i.messageId)>y(e,r.messageId))}).pop();return c?I(e,t,c):null}function O(e){return e&&e.length>0?a.eb([0].concat(e)):e}function w(e,t,n){var a=_(e,t),i=I(e,t,n),o=Object(s.r)(e);return Object(r.k)(i)?Object(c.c)(e,o.id).name:i.userId!==i.peerId?!!Object(c.b)(e,i.userId)&&Object(c.c)(e,i.userId).name:a.tab}function I(e,t,n){var r=_(e,t),a=r&&r.msgs&&r.msgs[n];return a?O(a):null}function x(e,t,n){var r=_(e,t),a=r&&r.msgs&&Object.keys(r.msgs).sort((e,t)=>+e-t);if(!a)return null;var i=a&&a.indexOf(""+n),c=i>-1?a[i-1]:null;return r.msgs[c]}function P(e){var t=Object(s.r)(e);return t.gid||t.isClassic}function D(e){return Object(s.r)(e).gid}function $(e){return Object(s.r)(e).gid}function T(e){return!!Object(s.r)(e).gid}function q(e,t){return!!(t.peerId>2e9&&Object(u.m)(t,1024))}function S(e,t){var n=Object(s.r)(t);return n.tabs[e]||n.mapped_index[e]}function E(e){var t=Object(s.r)(e);return!!T(e)&&((19542789===t.gid||103416369==t.gid)&&(t.active_tab===i.n||t.active_tab===i.m))}function A(e,t){var n=(e=Object(s.r)(e)).tabs;return!(!n||!n[t]||void 0===n[t].history||!n[t].msgs)}function C(e,t){var n=_(e,t);n&&(n.msgs=void 0,n.msgid=void 0,n.scrollTop=void 0,n.scrollBottom=void 0,n.contHeight=void 0,n.offset=void 0,n.skipped=void 0)}function z(e){var t=e.get().go_to_end_visible;return!!t&&t[0]}function M(e){var t=e.get().go_to_end_visible;return t?t[1]:0}function N(e){return!Object(s.r)(e).lockedSending}function H(e){return e>-2e9&&e<0}function B(e,t){return!!H(t)&&!!_(e,t).blocked_community}function L(e){return Object(s.r)(e).voice_message_available}function F(e){var t=Object(s.r)(e);return!(!R(t)&&!t.recentSearch)}function R(e){return Object(s.r)(e).searchText}function U(e,t){var n=Object(s.r)(e);return!!(t&&t!==R(e)||n.recentSearch)}function K(e){return Object(s.r)(e).recentSearch}function X(e){var t=h(e);return t&&t.pinned&&O(t.pinned)}function J(e){var t=e.get().popular_sugg;return t&&t.length>0}function V(e){return 1==Object(s.r)(e).isEditing}function Q(e){return Object(s.r)(e).gid}function G(e){return e.draft||(e.draft=Object(o.b)(cur.imDb,e.peerId)),e.draft}function Z(e){return(Object(s.r)(e).templates||[]).filter(e=>!e.deleted)}function W(e){return!!e&&(e.is_message_request||e.folders&i.j[i.k]||e.folders&i.j[i.l])}function Y(e){return e&~i.j[i.k]&~i.j[i.l]}function ee(e){return Object(s.r)(e).active_tab===i.k}function te(e){return e.peerId>19e8&&e.peerId<2e9}function ne(e){return!!Object(s.r)(e).dialog_tab_cts[i.k]}function re({type:e,updateType:t}){return e===a.e&&(t===a.A||t===a.x)}},rjmT:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s});n("KKXr"),n("Btvt"),n("OEbY"),n("pIFo");var r=n("BxOC"),a=n("f01n"),i=n("vT4u");function c(e,t){this._db=e,this._key=t,this.dData={txt:"",attaches:[],urlBinds:[],cancelled:[]},this.load()}function o(e){switch(e.type){case"mail":case"reply":return e.id<0&&1==e.object.fwd_count;default:return!e.object}}function s(e,t){return new c(e,"draft_"+t)}c.prototype.dump=function(){this._key&&this._db.updateByKey(this._key,function(e){return{txt:e.txt,attaches:e.attaches.length?e.attaches:void 0,urlBinds:e.urlBinds.length?e.urlBinds:void 0,cancelled:e.cancelled.length?e.cancelled:void 0}}(this.dData))},c.prototype.load=function(){if(this._key){var e=this._db.selectByKey(this._key);e&&(this.dData=function(e){return{txt:e.txt,attaches:e.attaches||[],urlBinds:e.urlBinds||[],cancelled:e.cancelled||[]}}(e))}},c.prototype.clear=function(){this.dData={txt:"",attaches:[],urlBinds:[],cancelled:[]},this.dump()},c.prototype.setText=function(e){this.dData.txt=trim(e),this.dump()},c.prototype.addAttach=function(e,t,n){if(("share"===e&&this.removeAttachByType(e),"mail"!==e&&"reply"!==e||(this.removeAttachByType("mail"),this.removeAttachByType("reply")),"audio_playlist"===e||"artist"===e)&&this.dData.attaches.find(t=>t.type===e))return!1;if(!e||!t&&"poll"!==e)return!1;var r=this.dData.attaches.findIndex(n=>n.type===e&&n.id===t);-1===r?(this.dData.attaches.push({type:e,id:t,object:n}),this.dump()):"video"!==e&&"poll"!==e||(this.dData.attaches[r]={type:e,id:t,object:n},this.dump())},c.prototype.syncWithSelector=function(e){var t=this.getFwdRaw();this.dData.attaches=(t?[t]:[]).concat(e.getMedias().map(([e,t])=>{return this.dData.attaches.find(n=>n.type==e&&n.id==t)||{type:e,id:t}})),this.dump()},c.prototype.removeAttachByType=function(e){for(var t=this.dData.attaches.length;t--;)this.dData.attaches[t].type===e&&this.dData.attaches.splice(t,1);this.dump()},c.prototype.removeAllAttaches=function(){this.dData.attaches=[],this.dData.cancelled=[],this.dump()},c.prototype.addBindUrl=function(e,t,n){this.getBoundAttach(e)||(this.dData.urlBinds.push({url:e,type:t,id:n}),this.dump())},c.prototype.getBoundAttach=function(e){var t=this.dData.urlBinds.find(t=>t.url===e);return t&&this.dData.attaches.find(e=>e.type===t.type&&e.id===t.id)||null},c.prototype.getShareUrl=function(){var e=this.dData.attaches.find(e=>"share"===e.type);if(e&&e.object)return e.object.url.replace(/&amp;/g,"&")},c.prototype.hasOnlyReplies=function(e=null){return e?e.flags&a.k&&!this.dData.attaches.find(e=>"mail"!==e.type):this.hasAttaches()&&!this.dData.attaches.find(e=>"reply"!==e.type)},c.prototype.getCancelledShares=function(){return this.dData.cancelled.length?this.dData.cancelled:void 0},c.prototype.hasAttaches=function(){return this.dData.attaches.length>0},c.prototype.destroy=function(){this.dData={},this._key=this._db=null},c.prototype.prepareObjects=function(e,t){return this.dData.attaches.find(o)?Object(r.b)(i.e,{act:"draft_medias",gid:e,messageId:t||0,media:t?void 0:this.dData.attaches.map(e=>[e.type,e.id]).join("*")}).then(([e])=>{this.dData.attaches=e.map(e=>({type:e[0],id:e[1],object:e[2]}))}):Promise.resolve()},c.prototype.getFwdRaw=function(){return this.dData.attaches.find(e=>"mail"===e.type||"reply"===e.type)},c.prototype.getFwdCount=function(){var e=this.getFwdRaw();return e?e.id<0?e.object.fwd_count:e.id.split(";").length:0}},uytb:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return s});var r="recent_search",a="pin_hide";function i(e){return"im_store_"+e}function c(e){return ls.get(i(e))||{}}function o(e,t,n){if(ls.checkVersion()){var r=JSON.stringify(t);rand(0,1e5)<=1&&statlogsValueEvent("im_local_store_size",r.length),n(i(e),r)}}function s(e){var t=debounce((e,t)=>{localStorage.setItem(e,t)},300);ls.checkVersion()&&function(e,t){for(var n=["fwd","draft","bind_attach"],r=c(e),a=!1,i=n.length;i--;)n[i]in r&&(delete r[n[i]],a=!0);a&&o(e,r,t)}(e,t);var n={db:c(e),checkTime:Date.now()},s=function(e,t,n){n.key===i(e)&&(t.db=JSON.parse(n.newValue),t.checkTime=Date.now())}.bind(null,e,n);return window.addEventListener("storage",s,!1),{select:(t,i)=>(Date.now()-n.checkTime>1e3&&(n.db=c(e)),function(e,t,n){return t===r?e[t]||[]:t===a?e[t]&&e[t][n]:e[t]?extend(!0,{},e[t][n]):null}(n.db,t,i)),selectByKey:t=>(Date.now()-n.checkTime>1e3&&(n.db=c(e)),n.db[t]),update(i,c){var s=function(e,t,n){switch(e[t]||(e[t]={}),t){case r:var i=n;i&&i.length>0?e[t]=i:delete e[t];break;case a:var[c,o]=n;o?e[t][c]=+o:delete e[t][c]}return e}(n.db,i,c);return n.db=s,n.checkTime=Date.now(),o(e,s,t)},updateByKey:(r,a)=>(n.db[r]=a,n.checkTime=Date.now(),o(e,n.db,t)),unmount(){window.removeEventListener("storage",s,!1)}}}},vT4u:function(e,t,n){"use strict";n.d(t,"e",function(){return y}),n.d(t,"b",function(){return k}),n.d(t,"d",function(){return O}),n.d(t,"c",function(){return w}),n.d(t,"a",function(){return D}),n.d(t,"jb",function(){return $}),n.d(t,"Bc",function(){return E}),n.d(t,"Qc",function(){return A}),n.d(t,"sb",function(){return C}),n.d(t,"Vb",function(){return z}),n.d(t,"Jb",function(){return M}),n.d(t,"jc",function(){return H}),n.d(t,"kc",function(){return L}),n.d(t,"p",function(){return F}),n.d(t,"ad",function(){return R}),n.d(t,"oc",function(){return U}),n.d(t,"qb",function(){return K}),n.d(t,"mb",function(){return X}),n.d(t,"Fb",function(){return V}),n.d(t,"nb",function(){return Q}),n.d(t,"ob",function(){return G}),n.d(t,"xc",function(){return Z}),n.d(t,"Qb",function(){return W}),n.d(t,"hd",function(){return ne}),n.d(t,"F",function(){return re}),n.d(t,"h",function(){return ae}),n.d(t,"wb",function(){return ce}),n.d(t,"xb",function(){return oe}),n.d(t,"T",function(){return se}),n.d(t,"Eb",function(){return ue}),n.d(t,"yb",function(){return de}),n.d(t,"cd",function(){return le}),n.d(t,"pc",function(){return fe}),n.d(t,"Pc",function(){return me}),n.d(t,"jd",function(){return be}),n.d(t,"lc",function(){return pe}),n.d(t,"D",function(){return ge}),n.d(t,"C",function(){return ve}),n.d(t,"j",function(){return je}),n.d(t,"t",function(){return ye}),n.d(t,"E",function(){return ke}),n.d(t,"Pb",function(){return Oe}),n.d(t,"pb",function(){return we}),n.d(t,"g",function(){return Ie}),n.d(t,"sc",function(){return xe}),n.d(t,"vc",function(){return Pe}),n.d(t,"rc",function(){return De}),n.d(t,"cc",function(){return $e}),n.d(t,"dc",function(){return Te}),n.d(t,"ub",function(){return qe}),n.d(t,"ic",function(){return Ee}),n.d(t,"ec",function(){return Ae}),n.d(t,"fc",function(){return Ce}),n.d(t,"Bb",function(){return ze}),n.d(t,"ib",function(){return Me}),n.d(t,"gc",function(){return Ne}),n.d(t,"X",function(){return He}),n.d(t,"Y",function(){return Be}),n.d(t,"m",function(){return Le}),n.d(t,"v",function(){return Fe}),n.d(t,"hc",function(){return Ue}),n.d(t,"kb",function(){return Ke}),n.d(t,"eb",function(){return Xe}),n.d(t,"Nb",function(){return Je}),n.d(t,"Mb",function(){return Ve}),n.d(t,"Lb",function(){return Qe}),n.d(t,"Ob",function(){return Ge}),n.d(t,"Wb",function(){return Ze}),n.d(t,"Xb",function(){return We}),n.d(t,"f",function(){return et}),n.d(t,"Gb",function(){return tt}),n.d(t,"nc",function(){return nt}),n.d(t,"mc",function(){return rt}),n.d(t,"K",function(){return at}),n.d(t,"Cb",function(){return it}),n.d(t,"B",function(){return ct}),n.d(t,"I",function(){return ot}),n.d(t,"Sc",function(){return st}),n.d(t,"gb",function(){return ut}),n.d(t,"i",function(){return dt}),n.d(t,"hb",function(){return lt}),n.d(t,"s",function(){return ft}),n.d(t,"rb",function(){return mt}),n.d(t,"Rc",function(){return bt}),n.d(t,"cb",function(){return ht}),n.d(t,"Zb",function(){return pt}),n.d(t,"Lc",function(){return gt}),n.d(t,"yc",function(){return vt}),n.d(t,"uc",function(){return jt}),n.d(t,"G",function(){return yt}),n.d(t,"Uc",function(){return kt}),n.d(t,"Zc",function(){return Ot}),n.d(t,"tb",function(){return wt}),n.d(t,"J",function(){return It}),n.d(t,"qc",function(){return xt}),n.d(t,"P",function(){return Pt}),n.d(t,"Db",function(){return Dt}),n.d(t,"w",function(){return $t}),n.d(t,"Yb",function(){return Tt}),n.d(t,"Mc",function(){return qt}),n.d(t,"tc",function(){return St}),n.d(t,"V",function(){return Et}),n.d(t,"gd",function(){return At}),n.d(t,"q",function(){return Ct}),n.d(t,"Tc",function(){return zt}),n.d(t,"ac",function(){return Mt}),n.d(t,"H",function(){return Nt}),n.d(t,"o",function(){return Ht}),n.d(t,"Wc",function(){return Lt}),n.d(t,"Jc",function(){return Ft}),n.d(t,"vb",function(){return Rt}),n.d(t,"O",function(){return Ut}),n.d(t,"Hb",function(){return Kt}),n.d(t,"Hc",function(){return Xt}),n.d(t,"y",function(){return Jt}),n.d(t,"Ub",function(){return Vt}),n.d(t,"Ac",function(){return Qt}),n.d(t,"ed",function(){return Gt}),n.d(t,"W",function(){return Zt}),n.d(t,"u",function(){return Wt}),n.d(t,"Cc",function(){return Yt}),n.d(t,"Xc",function(){return en}),n.d(t,"Gc",function(){return tn}),n.d(t,"Yc",function(){return nn}),n.d(t,"Dc",function(){return rn}),n.d(t,"l",function(){return an}),n.d(t,"zc",function(){return cn}),n.d(t,"Ic",function(){return on}),n.d(t,"dd",function(){return sn}),n.d(t,"U",function(){return un}),n.d(t,"Z",function(){return dn}),n.d(t,"M",function(){return ln}),n.d(t,"Rb",function(){return fn}),n.d(t,"db",function(){return mn}),n.d(t,"bc",function(){return bn}),n.d(t,"Sb",function(){return _n}),n.d(t,"Kb",function(){return hn}),n.d(t,"Ab",function(){return pn}),n.d(t,"Oc",function(){return gn}),n.d(t,"zb",function(){return vn}),n.d(t,"Nc",function(){return jn}),n.d(t,"Q",function(){return yn}),n.d(t,"N",function(){return kn}),n.d(t,"L",function(){return wn}),n.d(t,"Vc",function(){return In}),n.d(t,"Ib",function(){return xn}),n.d(t,"bb",function(){return Pn}),n.d(t,"ab",function(){return Dn}),n.d(t,"Fc",function(){return $n}),n.d(t,"Ec",function(){return Tn}),n.d(t,"r",function(){return qn}),n.d(t,"R",function(){return Sn}),n.d(t,"id",function(){return En}),n.d(t,"S",function(){return An}),n.d(t,"k",function(){return Cn}),n.d(t,"fb",function(){return zn}),n.d(t,"wc",function(){return Mn}),n.d(t,"z",function(){return Nn}),n.d(t,"Kc",function(){return Hn}),n.d(t,"lb",function(){return Bn}),n.d(t,"n",function(){return Ln}),n.d(t,"A",function(){return Fn}),n.d(t,"x",function(){return Rn}),n.d(t,"fd",function(){return Un}),n.d(t,"Tb",function(){return Kn}),n.d(t,"bd",function(){return Xn});n("a1Th"),n("OG14"),n("OEbY"),n("Vd3H"),n("tUrg"),n("SRfc"),n("rGqo"),n("Btvt");var r=n("BxOC"),a=n("nyd8"),i=n("f01n"),c=n("DM26"),o=n("aong"),s=n("uytb"),u=n("P13b"),d=n("h++7"),l=n("rHUl"),f=n("MhhX"),m=n("86+7"),b=n("ERyv"),_=n("Wu9C"),h=n("lJdi"),p=n("O8ze"),g=n("zxIV"),v=n("XzvV");function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var y="al_im.php",k=5,O="typing",w="audiomessage",{scheduleNav:I,commitNav:x,scheduleNavWithTimeOut:P}=Object(a.a)();var D={settings:0,block:1,fav:1,chat:2,invite:2,invite_link:3,topic:3,avatar:4,photos:5,search:6,pin_hide:7,pin_unhide:7,unpin:8,mute:10,unmute:10,clear:11,leave:12,return:12,block_community:12,allow_community:12,block_notify:12};function $(e,t,n){return Object(r.b)(y,{act:"a_renew_hash",peers:e.join(","),gid:t.hidegid?void 0:n.gid})}function T(e,t,n){return function(e){return e.resync_in_process?e.resync_in_process:Promise.resolve(!1)}(e).then(r=>r?t(...n):function(e){if(!e.renew_hashes){var t=e.last_hashes_update||0;if(Date.now()-t<1e4)return Promise.resolve();var n=Object.keys(e.tabs).filter(t=>Object(u.qb)(e,t));e.renew_hashes=$(n,{},e).then(([t,r])=>(n.forEach(n=>{e.tabs[n].hash=t[n]}),e.writeHash=r,delete e.renew_hashes,e.last_hashes_update=Date.now(),e))}return e.renew_hashes}(e).then(e=>t(...n)))}function q(e){return function(){var t=arguments,n=t[t.length-1];return e(...t).catch(r=>{if(r&&r.match&&r.match(/1001;/))return T(n,e,t);throw r})}}function S(e){return"string"==typeof e?Object(g.mb)(`<div>${e}</div>`):e}function E(e){return"string"==typeof e?e:e.innerHTML}function A(e,t){return t.block_states=extend(t.block_states,e),Promise.resolve(t)}function C(e,t,n,a,i){return i.tabHistoryNotChanged=!1,Object(c.e)(r.b,3,e=>e-1)(y,{act:"a_start",peer:e,msgid:n,history:t,prevpeer:i.prevPeer,gid:i.gid,block:a}).then(([t,r,a,c,o])=>{if(r.forEach(e=>Object(m.a)(i,e)),i.tabs||(i.tabs={}),i.dialog_tab_cts=Object.assign({},o,{[d.k]:i.dialog_tab_cts[d.k]}),i.tabs[e]||(i.tabs[e]=Object(u.Mb)(i,t)),A(c,i),n){if(i.tabs[e]){var s=i.tabs[e].lastmsg,l=i.tabs[e].lastmsg_meta;extend(i.tabs[e],t),i.tabs[e].lastmsg=s,i.tabs[e].lastmsg_meta=l}}else extend(i.tabs[e],t);return i.admins=extend(i.admins,a),i.imQueue(e,!1),En(),z(e,i)}).catch(e=>Object(b.a)("loadPeer",e))}function z(e,t){var n=t.imQueue(e,!1),r=t.tabs[e],a=n.filter(n=>!Object(l.M)(t,e,n.rid));return r.msgs=a.reduce((e,t)=>(e["rid"+t.rid]=t.mess,e),r.msgs),t.imQueueSet(e,a),t.tabs[e].history=Object(u.jc)(a,t,S(t.tabs[e].history)),Promise.resolve(t)}function M(e,t,n){var r=n.imQueue(e,!1).filter(e=>e.failed&&e.mess.messageId!==t);return n.imQueueSet(e,r),n.tabs[e].history=Object(u.Ob)([t],S(n.tabs[e].history)),Promise.resolve(n)}function N(e,t){return!1===(t.block_states[e]||{}).free?Promise.resolve(t):Object(r.b)(y,{act:"a_block",peer:e,prevPeer:t.prevPeer,gid:t.gid}).then(([e])=>A(e,t))}function H(e,t){var n=t.peer;return Promise.resolve(t).then(t=>(t.tabHistoryNotChanged=!1,Object(u.qb)(t,n)&&!t.tabs[n].msgid?(t.gid&&N(n,t),Promise.resolve(t).then(U)):(Object(u.qb)(t,n)&&(t.tabs[n].msgid=!1),C(n,e,!1,!0,t)))).then(U).then(B.bind(null,n))}function B(e,t,n=!1){return Object(u.Db)(t,e)&&(t.tabs[e].last_touched=Date.now()),Object(u.Db)(t,e)&&n&&(t.tabs[e].last_visited=Date.now()),t}function L(e,t,n){var r=n.msgid,a=n.peer;return!e&&Object(u.qb)(n,a)&&n.tabs[a].msgs[r]?(t===n.peer?n.tabHistoryNotChanged=!0:n.tabHistoryNotChanged=!1,n.gid&&N(a,n),Promise.resolve(n).then(U).then(B.bind(null,a))):C(a,!0,r,!0,n).then(U).then(()=>{return Object(l.u)(n,a).msgid=r,n}).then(B.bind(null,a))}function F(e,t,n,r){if(Et(r))throw Object(u.Cc)(),new Error("Cant change peer while loading something");var a=r.gid?"gim"+r.gid:"im";if(r.prevPeer=r.peer,r.peer=e,r.msgid=t||"",r.currentEntryPoint=n,cur.peer=e,I({sel:e?Object(u.I)(e):null,msgid:r.msgid,email:"",0:a}),0!=r.prevPeer&&B(r.prevPeer,r,!0),0!==e){Object(u.Db)(r,e)&&B(e,r,!0),Gt(r.tabbedPeers.map(e=>e.peer).indexOf(e)<0?[{peer:e,type:"perm"}].concat(r.tabbedPeers):r.tabbedPeers.map(t=>(t.peer==e&&"perm"!==t.type&&(t.type="perm"),t)),!1,r)}else Gt(r.tabbedPeers,!1,r);return x(),Le(r.prevPeer,r)}function R(e){cur.wallMentions=(()=>new Promise((t,n)=>{if(cur.wallMentions=[],!Object(u.ib)(e.peer)||!Object(u.qb)(e,e.peer)||Object(u.rb)(e,e.peer))return n();var r=e.tabs[e.peer];function a(){var n=[];Object.keys(r.msgs||{}).reverse().forEach(e=>{var t=Object(l.S)(r.msgs[e]),a=t&&t.userId;a&&a!=vk.id&&-1===n.indexOf(a)&&Object(u.Gb)(r,a)&&n.push(a)}),(r.memberIds||[]).forEach(e=>{-1===n.indexOf(e)&&n.push(e)});var a=[];n.forEach(t=>{if(Object(m.b)(e,t)){var n=Object(m.c)(e,t),r=n.link.substring(1);a.push([n.id,n.name,"@"+r,n.photo,void 0,void 0,void 0,r,n.first_name])}}),t(a)}r.membersLoaded?a():On(e.peer,e).then(a)}))}function U(e){var t=e.peer;if(0===t)return Promise.resolve(e);var n=e.tabs[t],r=[],a=Object(u.ib)(t)&&(n.data.closed||n.data.kicked),i=Object(u.rb)(e,t);n.offset&&r.push("photos"),n.offset&&r.push("search"),(t<-2e9||n.offset)&&!i&&r.push("clear"),Object(u.kb)(e)&&!i&&r.push("block"),i&&!a&&r.push("settings"),Object(u.lb)(t)&&(n.can_send_notify?r.push("block_notify"):r.push(n.blocked_community?"allow_community":"block_community")),(Object(u.ib)(t)||Object(u.Hb)(t)||Object(u.lb)(t))&&!Object(u.kb)(e)&&(Object(u.ib)(t)&&(n.data.kicked||n.data.closed)||r.push(inArray(t,e.mutedPeers)?"unmute":"mute")),Object(u.Hb)(t)&&!e.gid&&!n.blacklisted&&n.is_friend&&r.push("invite"),Object(u.ib)(t)&&!a&&(Object(h.h)(e)&&r.push("invite"),e.gid||r.push("leave")),Object(u.ib)(t)&&n.data.closed&&!n.data.kicked&&r.push("return"),Object(u.ib)(t)&&n.pinned&&(r.push(Object(_.a)(e,t)?"pin_hide":"pin_unhide"),Object(h.j)(e)&&r.push("unpin"));var c=Object(u.D)(e,i);return e.curActions=r.sort((e,t)=>D[e]-D[t]).reduce((e,t)=>(e[t]=c[t],e),{}),Promise.resolve(e)}function K(e,t,n){var a=n.tabs[n.peer];return Object(r.b)(y,{peer:n.peer,whole:e,act:"a_history",offset:a.offset+(a.skipped||0),toend:t,gid:n.gid}).then(([e,t,r,i])=>(a.allShown=r,n.admins=extend(n.admins,i),a.history=e+E(a.history),a.historyToAppend=e,a.offset+=Object.keys(t).length,a.msgs=extend(a.msgs,t),n))}function X(e){var t=e.tabs[e.peer];return Object(r.b)(y,{peer:e.peer,act:"a_history",rev:1,offset:t.skipped,gid:e.gid}).then(([n,r,a,i,c])=>{t.allShown=t.allShown||a,t.history=E(t.history)+n,t.historyToAppend=n;var o=Object.keys(r).length;return t.skipped-=o,t.offset+=o,t.msgs=extend(t.msgs,r),e})}function J(e,t,n,r){var a=e.tabs[t];return r===i.m&&a.out_up_to>n?e:(r===i.m?a.out_up_to=n:a.in_up_to=n,e)}var V=q(function(e,t){if(Object(u.Hc)(t.tabs[e]))return Promise.resolve(t);var n=t.tabs[e],a=n.msgs||{},c=Object.keys(a).map(n=>Object(l.n)(t,e,n)).filter(e=>!Object(f.k)(e)).map(e=>e.messageId).sort((e,t)=>t-e);return n.skipped>0&&(c=c.filter(e=>intval(e)<=n.lastmsg-n.skipped)),(c=intval(c.shift()))<=n.in_up_to?Promise.resolve(t):(t.longpoll.push([i.ub([6,e,c])]),Object(r.b)(y,{peer:e,ids:[c],hash:n.hash,act:"a_mark_read",gid:t.gid}).then(()=>J(t,e,c,i.m)))});function Q(e){return Object(r.b)(y,{act:"a_get_key",uid:e.id,gid:e.gid}).then(([t,n,r])=>extend({},e,{imKey:t,imUrl:n,imPart:r}))}function G(e){return Object(r.b)(y,{act:"a_get_ts",gid:e.gid}).then(([t])=>extend({},e,{imTs:t}))}function Z(e,t,n){var r=n.tabs[e];return r.msgs[t.messageId]&&(r.msgs[t.messageId].errored=1,r.history=Object(u.mc)(e,t,S(r.history))),Promise.resolve(n)}function W(e,t,n,r){var a=r.tabs[e];return a.msgs[t]&&(a.msgs[t].errored=0,a.lastmsg_meta=n,a.lastmsg=t,a.history=Object(u.Fc)(e,t,S(a.history))),Promise.resolve(r)}function Y(e,t,n,r,a=!1){t.deletedDialog||(e.dialog_tabs=Object.keys(e.dialog_tabs).reduce((e,i)=>(!n&&!Nt(i)(t)||a&&!a(i,e[i],t)||(e[i]=Object(o.a)(r(e[i],i))),e),e.dialog_tabs))}function ee(e,t){if(!inArray(e,t.tabbedPeers.map(e=>e.peer))&&(0!==t.peer||t.searchText)&&!inArray(e,t.mutedPeers)){var n={peer:e,type:"temp"};Gt(t.tabbedPeers.concat([n]),!1,t)}}function te(e,t,n){return Object(u.Bb)(n)?t.concat([e]):[e].concat(t)}function ne(e,t){var n=e.get().peer,r=Object(l.u)(e,n);if(Object(u.qb)(e,n)){var a=S(r.history);r.history=Object(u.Lc)(e,a,t)}}function re(e,t){var n=Object(l.u)(t,e.peerId);if(Object(u.qb)(t,e.peerId)){var r=S(n.history);n.msgs[e.messageId]=extend(!0,{},e),n.history=Object(u.K)(t,e,r)}n&&n.lastmsg==e.messageId&&(n.lastmsg_meta=e);var a=n&&n.pinned&&Object(l.S)(n.pinned);return a&&a.messageId==e.messageId&&(n.pinned=e),Promise.resolve(t)}function ae(e,t){var n=e.flags&i.m,r=e.peerId;if(Object(u.Db)(t,r)){var a=t.tabs[r];if(a.deletedDialog=!1,!t.msg_local_ids_sort&&e.local?t.msg_local_ids_sort={[e.messageId]:0}:e.local&&(t.msg_local_ids_sort[e.messageId]=Object.keys(t.msg_local_ids_sort).length),n||Object(u.Hc)(a)?a.unread=0:(a.lastmsg==e.messageId&&a.unread?ie(t,1,e.peerId):(!a.unread&&ie(t,1,e.peerId),a.unread++),ee(e.peerId,t)),Object(u.qb)(t,r)){var c=S(a.history);a.skipped>0&&a.skipped++,a.offset++,a.msgs[e.messageId]=extend(!0,{},e),a.history=Object(u.x)(t,e,c,!0,!0,!0),Object(f.k)(e)&&(a.blocked_community=0,U(t))}if(a.typing){var o=a.typing.userIds.indexOf(e.userId);o>=0&&a.typing.userIds.splice(o,1)}return a.lastmsg=e.messageId,a.lastmsg_meta=e,B(e.peerId,t),Y(t,a,!1,te.bind(null,r),Bt.bind(null,t)),Promise.resolve(t)}return C(r,0,0,0,t).then(t=>{return Y(t,t.tabs[r],!1,te.bind(null,r),Bt.bind(null,t)),B(e.peerId,t),n||ee(e.peerId,t),t})}function ie(e,t,n){e.cur_unread_cnt||(e.cur_unread_cnt={}),-1===t&&delete e.cur_unread_cnt[n],e.unread_cnt+=t}function ce(e,t){if(Object(u.qb)(t,e.peerId)){var n=t.tabs[e.peerId],r=n.unread;if(t=J(t,e.peerId,e.upToId,0),null!=e.unread?n.unread=e.unread:n.unread=e.upToId>=n.lastmsg?0:Object(l.b)(e.peerId,t)+(n.unread>0?+n.skipped:0),r>0&&!n.unread&&ie(t,-1,e.peerId),!n.skipped){var a=S(n.history);n.history=Object(u.Rb)(t,a,e.peerId)}}else Object(u.Db)(t,e.peerId)&&(t.tabs[e.peerId].unread>0&&ie(t,-1,e.peerId),t.tabs[e.peerId].unread=0,t.tabs[e.peerId].in_up_to=e.upToId);return Object(u.Db)(t,e.peerId)&&(t.dialog_tabs[d.m]=t.dialog_tabs[d.m].filter(t=>intval(t)!==e.peerId)),0!==t.unread_cnt||t.active_tab!==d.m||t.gid?Promise.resolve(t):Ht(d.h,t)}function oe(e,t){var n=t.tabs[e.peerId];if(Object(u.Db)(t,e.peerId)&&J(t,e.peerId,e.upToId,i.m),Object(u.qb)(t,e.peerId)){var r=S(n.history);n.history=Object(u.Lb)(t,e.peerId,r)}return Promise.resolve(t)}function se(e,t,n,r,a){return a.text={},a.imQueue=e,a.imQueueResend=t,a.imQueueSet=n,a.imQueueComplete=r,Promise.resolve(a)}function ue(e,t,n){function r(e,t){return{id:e.messageId,text:e.text,date:e.date,kludges:e.kludges,authorName:t}}if(1===e.length){var a=e[0],i=Object(l.n)(n,t,a),c=Object(l.e)(n,t,a);return!1===c?n.set(lt.bind(null,{[t]:[i.userId]})).then(n=>{var c=Object(l.e)(n,t,a);return{msgIds:e,object:r(i,c)}}):Promise.resolve({msgIds:e,object:r(i,c)})}return Promise.resolve({msgIds:e})}function de(e,t){Object(u.Nb)(t,e);var n=t.tabs[t.peer];return t.tabs=Object.keys(e).reduce((n,r)=>{var a=t.tabs[r]?t.tabs[r].msgs:{},i=extend({},a||{},e[r].msgs||{});return n[r]=extend(t.tabs[r]||{},e[r]),i&&(n[r].msgs=i),e[r].lastmsg||(n[r].lastmsg=!1),n},t.tabs),n&&(t.tabs[t.peer]=n),Promise.resolve(t)}function le(e,t,n,r){var a=Object(l.u)(r,e);if(a){var i=!1!==t?mobPlatforms[t]?1:0:a.last_seen[2];a.online=t,a.last_seen=[t,n||a.last_seen[1],i]}return Promise.resolve(r)}function fe(e,t,n){var r=Object(l.u)(n,e.peerId);return r&&(e.ts=Date.now()/1e3,r.activity||(r.activity={}),r.activity[t]=e,r.typing===O&&(r.typing=e)),Promise.resolve(n)}function me(e,t){var n=Object(l.u)(t,e.peerId),r=Object(f.d)(e)?"audiomessage":"typing";return n&&n.activity&&n.activity[r]&&(n.activity[r].userIds=n.activity[r].userIds.filter(t=>t!==e.userId)),Promise.resolve(t)}function be({peerId:e},t,n){return Object(c.c)(k+2).then(()=>{if(Object(u.Db)(n,e)){var r=n.tabs[e];if((r.activity||{})[t])Date.now()-1e3*r.activity[t].ts>=1e3*k&&(delete r.activity[t],0===Object.keys(r.activity)&&delete r.activity);if(r.typing)Date.now()-1e3*r.typing.ts>=1e3*k&&(r.typing=void 0)}return n})}function _e(e){var t={},n=e.find(e=>"poll"===e[0]);if(n){var[,,r]=n;Object.assign(t,r)}return t}function he(e){return e.map(e=>{var t="audiomsg"===e[2]?"audio_message":e[2];return`${e[0]}:${e[1]}:${t}`}).join(",")}var pe=function(e,t,n,a){var i=Date.now()+rand(0,100).toFixed(0),c=a.ref_id,o=a.ref_source;a.ref_source=void 0,a.ref_id=void 0,(o||c)&&(I({ref_source:null,ref:null}),x()),Object(p.i)(a);var s=t.attaches.length>0,u=Object(p.k)(a,"send","server",s),d=Object.assign({act:"a_send",to:e,hash:n.hash,ref_source:o,ref:c,msg:t.message,payload:t.payload,media:he(t.attaches),guid:i,share_url:t.share_url,cancelled_shares:t.cancelled_shares,random_id:t.rid,gid:n.hidegid?void 0:a.gid,entrypoint:a.currentEntryPoint||"",sticker_referrer:t.sticker_referrer},n.external,_e(t.attaches));return Object(r.b)(y,d,2e4).then(([e])=>(u(),a.version!==e.version&&nav.reload({force:!0}),a.currentEntryPoint="",a)).catch(e=>{throw Object(p.h)(a,e,"send","server_send"),e})},ge=q(function(e,t,n={},r){var a=r.tabs[e];return pe(e,t,j({hash:a.hash},n),r)}),ve=q(function(e,t,n){var a=t.attaches.length>0,i=Object(p.k)(n,"edit","server",a);return Object(r.b)(y,Object.assign({act:"a_edit_message",hash:e.hash,id:t.messageId,peerId:e.peerId,gid:n.gid,msg:t.origText,media:he(t.attaches),share_url:t.share_url,cancelled_shares:t.cancelled_shares},_e(t.attaches)),2e4).then(([e])=>(i(),n)).catch(e=>{throw Object(p.h)(n,e,"edit","server_send"),e})});function je(e,t){if(t.selectedMessages||(t.selectedMessages=[]),1===e.length&&inArray(e[0],t.selectedMessages))t.selectedMessages=t.selectedMessages.filter(t=>t!==e[0]);else{var n=t.selectedMessages.concat(e);t.selectedMessages=Object(o.a)(n).sort((e,t)=>e-t)}return Promise.resolve(t)}function ye(e){return e.selectedMessages=[],Promise.resolve(e)}function ke(e){return e.selectedMessages=[],Promise.resolve(e)}function Oe(e,t){if(Object(u.qb)(t,e.peerId)){var n=t.tabs[e.peerId],r=t.imQueue(e.peerId).filter(t=>t.failed&&t.rid!==e.randomId);t.imQueueSet(e.peerId,r),t.imQueueComplete(e.peerId,e.randomId),n.lastmsg_meta=e,n.lastmsg=e.messageId,n.msgs["rid"+e.randomId]&&(n.msgs[e.messageId]=e,delete n.msgs["rid"+e.randomId]),n.history=Object(u.gc)(t,S(n.history),e)}return Promise.resolve(t)}function we(e,t){var n=Object(p.k)(t,"unknown","attach"),a={act:"a_get_media",id:e.messageId,gid:t.gid};return Object(c.e)(r.b,3,e=>e*e)(y,a).then(r=>(n(),Ie(e,r,t))).catch(n=>(Object(p.h)(t,n,"unknown","server_load_attach"),Ie(e,null,t)))}function Ie(e,t,n){var r=n.tabs[e.peerId];return r.mediacontent||(r.mediacontent={}),r.mediacontent[e.messageId]=t||[getTemplate("im_retry_link")],function(e,t){var n=t.tabs[e.peerId];return n.history=Object(u.fc)(S(n.history),e,t),Promise.resolve(t)}(e,n)}function xe(e,t,n){var r=Object(u.J)(t),a=n.tabs[e];return a.searchDay=r,a.searchOffset=0,a.searchAllLoaded=!1,Promise.resolve(n)}function Pe(e,t,n){return n.tabs[t].searchText=e,Re(t,n),n}function De(e,t,n){if(t){var r=n.tabs[t];r.searchText=e,r.searchOffset=0,r.searchAllLoaded=!1}else n.searchText=e,n.searchOffset=0,n.searchAllLoaded=!1;return Promise.resolve(n)}function $e(e,t,n,a,i){var c=+new Date;return Object(r.b)(y,{act:"a_hints",str:e,gid:a.hidegid?0:i.gid,query:n,peerIds:t.join(",")}).then(([t,n,r])=>(A(r,i),n.forEach(e=>Object(m.a)(i,e)),de(t,i),Object(v.c)("messages",c,t&&t.length,e),Object.keys(t).sort((e,n)=>t[e].order-t[n].order).map(e=>t[e])))}function Te(e,t,n,r){return $e(e,t,n,{},r).then(e=>e.map(e=>({peerId:e.peerId,name:e.tab,photo:e.photo,online:e.online,is_friend:"friends"===n})))}function qe(e){var t={peerId:e[0],name:e[1],tab:e[1],photo:e[2],href:e[3],online:e[4],is_friend:e[5],local_index:!0};return e[6]&&(t.data={flags:e[6]}),t}function Se(e){return(t,n)=>e(n).then(e=>{var r=(t?e.search(t):e.list).map(qe);return n.mapped_index||(n.mapped_index={}),r.forEach(e=>{n.mapped_index[e.peerId]=e}),r})}var Ee=Se(e=>e.topConvTree),Ae=Se(e=>e.imTopConvTree),Ce=Se(e=>e.hintsTree);function ze(e,t){var n,a,i;t.topConvTree=new Promise(e=>{n=e}),t.hintsTree=new Promise(e=>{a=e}),t.imTopConvTree=new Promise(e=>{i=e});var o=e.select(s.b);return Object(c.e)(r.b,1,()=>4)(y,{act:"a_dialogs_preload",rs:o.join(","),gid:t.gid}).catch(e=>[[],[],[]]).then(([e,r,c,o])=>(t.popular_sugg=c,new vkIndexer(e,e=>e[1],n),new vkIndexer(r,e=>e[1],a),o&&o.length>0?new vkIndexer(o,e=>e[1],i):i(),t))}function Me(e){var t,n=e.active_tab;return t=e.dialog_tabs[n].length>0?Math.min.apply(null,e.dialog_tabs[n].map(t=>e.tabs[t].lastmsg)):0,Object(r.b)(y,{act:"a_get_dialogs",start_message_id:t,tab:n,gid:e.gid}).then(([t,r,a,i])=>(a.forEach(t=>Object(m.a)(e,t)),A(i,e),de(r,e),e.dialog_tabs[n]=e.dialog_tabs[n].concat(Object.keys(r).map(intval)),e.dialog_tabs_all[n]=!t.has_more,Promise.resolve(e)))}var Ne=q(function(e,t){return Object(r.b)(y,{act:"a_search",q:e,from:"all",gid:t.gid,hash:t.writeHash,offset:t.searchOffset||0}).then(([n,r,a,i,c])=>(r.forEach(e=>Object(m.a)(t,e)),Object(u.Nb)(t,n),e===t.searchText&&(t.searchOffset=i,t.searchAllLoaded=c),Object.keys(n).filter(e=>!t.tabs[e]).forEach(e=>{t.tabs[e]=n[e]}),[n,a]))});function He(e,t){return t.tabs[e].searchAllLoaded}function Be(e,t){return!(t.peer!==e||!Object(u.qb)(t,e))&&t.tabs[e].inplaceSearch}function Le(e,t){if(Object(u.qb)(t,e)){var n=t.tabs[e];delete n.inplaceSearch,delete n.searchOffset,delete n.searchAllLoaded,delete n.searchText,delete n.searchDay,I({st:""}),x()}return Promise.resolve(t)}function Fe(e,t){if(Object(u.qb)(t,e)){var n=t.tabs[e];delete n.searchDay,n.searchOffset=0,n.searchAllLoaded=!1}return Promise.resolve(t)}function Re(e,t){return t.tabs[e].inplaceSearch=!0,Promise.resolve(t)}var Ue=q(function(e,t){var n=t.tabs[e],a="";if(Re(e,t),n.searchDay&&(a=`day:${n.searchDay}`),!a&&!n.searchText)return Promise.reject();var i=`in:${e} ${a} ${n.searchText||""}`;return I({st:n.searchText}),x(),Object(r.b)(y,{act:"a_search",q:i,from:"in",gid:t.gid,hash:t.writeHash,offset:n.searchOffset||0}).then(([e,t,r])=>(n.searchOffset=t,n.searchAllLoaded=r,e))});function Ke(e){return Object(r.b)(y,{act:"a_important",offset:e,part:e>0})}function Xe(e,t){var n=Object(l.u)(e,t);return Object(r.b)(y,{act:"a_load_lastmsg",peerId:t,gid:e.get().gid}).then(([r,a])=>{n.lastmsg=r[0]||!1,n.lastmsg_meta=r,[n.unread,n.in_up_to,n.out_up_to]=a,n.unread||(e.get().dialog_tabs[d.m]=e.get().dialog_tabs[d.m].filter(e=>e!=t)),Y(e.get(),n,!1,te.bind(null,t),Bt.bind(null,e.get()))})}function Je(e,t,n){if(Object(u.qb)(n,t)){var r=n.tabs[t];r.deleted=r.deleted?r.deleted.concat(e):e}return Promise.resolve(n)}function Ve(e,t,n){if(Object(u.qb)(n,t)){var r=n.tabs[t];r.history=Object(u.Ob)(e,S(r.history)),r.offset-=e.filter(e=>r.msgs[e]).length,e.forEach(e=>delete r.msgs[e]),e.forEach(e=>{var t=(n.selectedMessages||[]).indexOf(e);-1!=t&&n.selectedMessages.splice(t,1)})}return Promise.resolve(n)}var Qe=q(function(e,t,n,a,i){return Object(r.b)(y,{act:"a_mark",peer:t,hash:n||i.tabs[t].hash,gid:i.gid,msgs_ids:e.join(","),mark:a})});function Ge(e,t,n,r){if(Object(u.qb)(r,t)){var a=r.tabs[t];a.deleted=a.deleted?a.deleted.concat(e):e,a.history=Object(u.Pb)(e,t,n,S(a.history)),a.offset-=e.filter(e=>a.msgs[e]).length}return Promise.resolve(r)}function Ze(e,t,n){if(Object(u.qb)(n,t)){var r=n.tabs[t];r.deleted&&(r.deleted=r.deleted.filter(t=>t!==e)),r.history=Object(u.ic)(e,t,S(r.history)),r.offset++}return Promise.resolve(n)}function We(e,t,n,a){return Object(r.b)(y,{act:"a_restore",id:e,peer:t,hash:n,gid:a})}var Ye=q(function(e,t,n){return Object(u.Hc)(n.tabs[e])?Promise.resolve(n):(n.tabs[e].lastTyping=Date.now(),Object(r.b)(y,{act:"a_activity",type:t,peer:e,gid:n.gid,hash:n.tabs[e].hash}).then(()=>n,()=>n))}),et=q((e,t)=>Object(r.b)(y,{act:"a_accept_message_request",user_id:e,hash:t.tabs[e].hash}).then(()=>{var n=t.tabs[e];return n.is_message_request=!1,n.folders=Object(l.T)(n.folders),t})),tt=q((e,t)=>Object(r.b)(y,{act:"a_reject_message_request",user_id:e,hash:t.tabs[e].hash}).then(()=>(Y(t,t.tabs[e],!0,t=>t.filter(t=>t!==e)),Gt(t.tabbedPeers.filter(t=>t.peer!==e),!0,t),t.tabs[e].unread=0,t.tabs[e].lastmsg=!1,t.tabs[e].lastmsg_meta=null,t))),nt=q(function(e,t){return Ye(e,O,t)}),rt=q(function(e,t){return Ye(e,w,t)});function at(e,t,n,r){return t&&(r.pendingForward=null,e||(e={msgIds:[]}),t.addAttach(n?"reply":"mail",e.msgIds.join(";"),e.object||null)),Promise.resolve(r)}function it(e,t){return t.pendingForward=e,Promise.resolve(t)}function ct(e,t,n){if(Object(u.Db)(n,e)){n.blockedFlagUpdates||(n.blockedFlagUpdates={}),n.blockedFlagUpdates[e]=!0,Y(n,n.tabs[e],!0,t=>t.filter(t=>t!==e)),n.tabs[e].unread>0&&ie(n,-1,e);var r=n.tabs[e];return r.deletedDialog=!0,Gt(n.tabbedPeers.filter(t=>t.peer!==e),!0,n),t.then(([t,a])=>(delete n.blockedFlagUpdates[e],r.msgs=null,r.history=null,r.unread=0,r.lastmsg=!1,r.lastmsg_meta=null,n))}}var ot=q(function(e,t){return ct(e,Object(r.b)("al_im.php",{act:"a_flush_history",id:e,from:"im",gid:t.gid,hash:t.tabs[e].hash}),t)}),st=q(function(e,t,n){return Object(r.b)(y,{act:"a_set_chat_title",peer:e,new_title:t,gid:n.gid,hash:n.tabs[e].hash}).then(()=>n)}),ut=q(function(e,t){return Object(r.b)(y,{act:"a_load_chat_info",peer:e,gid:t.gid,hash:t.tabs[e].hash}).then(([n])=>(t.tabs[e]=extend(t.tabs[e],n),t))});var dt=q(function(e,t,n){return Object(r.b)(y,{act:"a_add_chat_members",peer:e,new_peer:t.join(","),gid:n.gid,hash:n.tabs[e].hash}).then(e=>n)});function lt(e,t){if(isEmpty(e))return Promise.resolve(t);var n=Object.keys(e).map(t=>`${t}:${e[t].join(",")}`).join(";");return Object(r.b)(y,{act:"a_load_member",need:n}).then(([e])=>(e.forEach(e=>Object(m.a)(t,e)),t))}function ft(e,t,n){var r={},a=n.get();function c(e,t){Object(u.ib)(e)&&t&&!Object(m.b)(a,t)&&(r[e]?-1===r[e].indexOf(t)&&r[e].push(t):r[e]=[t])}var o=t.filter(e=>!Object(u.Db)(a,e.peerId)).map(e=>e.peerId);t.forEach(e=>{c(e.peerId,e.userId)}),e.forEach(e=>{c(e.peerId,+e.kludges.source_mid)});var s=t.filter(e=>e.flags&i.m&&!e.local).map(e=>e.kludges.from_admin).filter(e=>e&&!a.admins[e]);return 0===Object.keys(r).length&&0===s.length&&0===o.length?Promise.resolve(a):{shouldLoad:Object.keys(r).length>0||s.length>0||o.length>0,needMembers:r,needAdminIds:s,needPeers:o}}function mt({needMembers:e,needAdminIds:t,needPeers:n},a,i){return a.pause(),Promise.all([lt(e,i),function(e,t){return 0===e.length?Promise.resolve(t):Object(r.b)(y,{act:"a_get_admin",admins:e.join(","),gid:t.gid}).then(([e])=>(t.admins=extend(t.admins,e),t))}(t,i),Promise.all(n.map(e=>C(e,0,0,0,i)))]).catch(()=>i).then(()=>a.resume()).then(()=>i)}var bt=q(function(e,t){return e.kludges.source_act===u.d?(delete t.tabs[e.peerId].photo,delete t.tabs[e.peerId].photoLarge,Promise.resolve(t)):Object(r.b)(y,{act:"a_get_chat_photo",msg_id:e.messageId}).then(([n,r])=>{t.chat_photo_msg=r;var a=t.tabs[e.peerId];if(t.tabs[e.peerId].photo=n[0],t.tabs[e.peerId].photoLarge=n[1],Object(u.qb)(t,e.peerId)){var i=e.kludges.source_act;a.history=Object(u.w)(e,i,t,S(a.history))}return t})});function _t(e,t,n,r){return t!==vk.id?Promise.resolve(r):(Object(u.Db)(r,n)&&r.peer==n&&(r=U(r)),Promise.resolve(r))}var ht=q(function(e,t){return Object(r.b)(y,{act:"a_leave_chat",chat:e-2e9,gid:t.gid,hash:t.tabs[e].hash}).then(_t.bind(null,u.c,vk.id,e,t))}),pt=q(function(e,t){return Object(r.b)(y,{act:"a_return_to_chat",chat:e-2e9,gid:t.gid,hash:t.tabs[e].hash}).then(_t.bind(null,u.b,vk.id,e,t))}),gt=q(function(e,t,n){return Object(r.b)(y,{act:"a_mute",peer:e,hash:n.tabs[e].hash,gid:n.gid,value:t?1:0}).then(()=>{var r=t?"mute":"unmute";return window.Notifier&&Notifier.lcSend("im",{act:r,peer:e}),n}).then(vt.bind(null,e,t))});function vt(e,t,n){var r=n.mutedPeers.filter(t=>t!==e);return t&&r.push(e),n.mutedPeers=r,cur.mutedPeers=n.mutedPeers,U(n)}function jt(e,t){return t.stack=e,Promise.resolve(t)}var yt=q(function(e,t,n,a){return kt(e,n,t,a),Object(r.b)(y,{act:"a_mark_important",ids:e,val:t?1:0,from:"im",gid:a.gid,peer:n,hash:a.tabs[n].hash}).then(()=>a)});function kt(e,t,n,r){if(Object(u.qb)(r,t)){var a=r.tabs[t];e.filter(e=>a.msgs[e]).forEach(e=>{var c=Object(l.n)(r,t,e),o=n?c.flags|i.l:c.flags&~i.l;c.flags=o,a.msgs[e]=c,a.history=Object(u.Nc)(e,n,S(a.history))})}return Promise.resolve(r)}function Ot(e,t,n){return n.importants||(n.importants={}),(n.importants[t]||0)!==e&&(n.important_cnt+=e,n.importants[t]=e),Promise.resolve(n)}function wt(e,t){return Object(r.b)(y,{act:"a_spam",offset:e,gid:t,part:e>0})}function It(e,t){return Object(r.b)(y,{act:"a_flush_spam",gid:t,hash:e})}function xt(e,t,n){return n.creationType=e,n.creationFilter=t,Promise.resolve(n)}function Pt(e,t){return Object(r.b)(y,{act:"a_owner_photo",photo:JSON.parse(e).data[0],peer:t})}function Dt(e,t){return t.next_chat_avatar=e,Promise.resolve(t)}var $t=q(function(e,t,n,a){return a.creating=!0,a.longpoll.pause(),Object(r.b)(y,{act:"a_multi_start",hash:a.writeHash,peers:t.join(","),title:n}).then(([e])=>(a.next_peer=e.peerId,a.tabs[e.peerId]=e,Y(a,e,!1,t=>[e.peerId].concat(t)),a.longpoll.resume(),a)).then(t=>e?function(e,t,n){return Object(r.b)("al_page.php",{act:"owner_photo_save",peer:e,_query:t}).then(e=>n)}(t.next_peer,e,t):t).then(e=>(e.creating=!1,e)).catch(e=>{throw a.creating=!1,a.longpoll.resume(),e})});function Tt(e){var t;e.resync_in_process=new Promise(e=>{t=e});var n=Object.keys(e.tabs).length,a=e.active_tab;return Object(r.b)(y,{act:"a_resync",sel:e.peer,gid:e.gid,loaded:n,tab:a,add_peers:e.tabbedPeers.map(e=>e.peer).join(",")}).then(([n,r,i,c,s])=>{r.forEach(t=>Object(m.a)(e,t)),Object(u.Nb)(e,n),i.user_unread&&handlePageCount("msg",i.user_unread),Object(o.i)("Resync success","success");var l,f=e.peer;if(Object(u.Ab)(f))l=Promise.resolve(!1);else{var b={tabs:{[f]:e.tabs[f]},oCache:{}};l=de({[f]:n[f]},b)}return l.then(r=>{e.tabs=n,e.admins=extend(e.admins,c),r&&(e.tabs[f]=r.tabs[f],e.tabs[f].history=Object(u.jc)(f,e,S(e.tabs[f].history))),e.loadingDialogs=!1,e.mutedPeers=i.mutedPeers,e.lastDialogsOptions={has_more:i.has_more},e.dialog_tab_cts=Object.assign({},i.folder_cts,{[d.k]:e.dialog_tab_cts[d.k]}),e.dialog_tabs[a]=s.map(intval);var o=e.dialog_tabs[a].map(t=>e.tabs[t]);return Object.keys(e.dialog_tabs).filter(e=>e!=a).forEach(t=>{a==d.h?e.dialog_tabs[t]=o.filter(Nt(t)).map(e=>e.peerId):e.dialog_tabs[t]=[]}),delete e.resync_in_process,setTimeout(t.bind(null,!0),0),At(intval(i.unread),e)})}).catch(t=>(Object(o.i)("Resync error: "+t.message+" "+t.stack,"error"),Object(c.c)(2).then(Tt.bind(null,e))))}function qt(e,t){return t.lockedSending=e,Promise.resolve(t)}function St(e,t,n){return e&&!n.delayed_message?(n.delayed_message=e,n.delayed_ts=t):e||(n.delayed_message=e,n.delayed_ts=t),Promise.resolve(n)}function Et(e){return!!e.textMediaSelector.urlAttachmentLoading||!!(window.Upload&&Upload.options&&Upload.isSomethingUploading)&&Object.keys(Upload.options).filter(e=>Upload.isSomethingUploading(e)).length>0}function At(e,t){return t.unread_cnt=e,t.dialog_tab_cts[d.m]=e,Promise.resolve(t)}function Ct(e,t){return t.ctrl_submit=!!e,Object(r.b)(y,{act:"a_save_ctrl_submit",to:t.peer,hash:t.tabs[t.peer].hash,value:e?1:0}).then(e=>t)}function zt(e,t,n){n.cur_unread_cnt||(n.cur_unread_cnt={}),t&&!inArray(e,n.mutedPeers)&&(n.cur_unread_cnt[e]=!0);var r=document.title,a=window.devicePixelRatio>=2?"_2x":"";if(t&&!n.update_title_to){var i=function(e,t,n){return function(){n.update_old_title=e;var r=Object.keys(n.cur_unread_cnt).length;if(0===r)return Object(g.ob)(e||document.title),setFavIcon("/images/icons/favicons/fav_im"+t+".ico"),clearInterval(n.update_title_to),void(n.update_title_to=!1);e?(Object(g.ob)(e),setFavIcon("/images/icons/favicons/fav_im"+t+".ico"),e=!1):(e=document.title,setFavIcon("/images/icons/favicons/fav_im"+(r>9?10:r)+t+".ico"),Object(g.ob)(winToUtf(getLang("mail_im_new_messages",r))))}}(r,a,n);n.update_title_to=setInterval(i,1e3),i()}else!t&&n.update_old_title&&(Object(g.ob)(n.update_old_title),n.cur_unread_cnt={},r=!1,n.update_old_title=!1,setFavIcon("/images/icons/favicons/fav_im"+a+".ico"),clearInterval(n.update_title_to),n.update_title_to=!1);return Promise.resolve(n)}function Mt(e,t,n,r,a){return Object(u.qb)(a,e)&&(a.tabs[e].scrollTop=intval(t),a.tabs[e].scrollBottom=intval(n),a.tabs[e].contHeight=intval(r)),Promise.resolve(a)}function Nt(e){return e===d.h?e=>!Object(u.Hc)(e):e===d.m?e=>!Object(u.Hc)(e)&&e.unread>0:t=>t.folders&d.j[e]}function Ht(e,t){t.active_tab=e,Object(a.b)({tab:e===d.h?null:e});var n=[];if(e!==d.h&&!Object(u.Bb)(t)){var r=t.dialog_tabs[e];n=t.dialog_tabs[d.h].map(e=>t.tabs[e]).filter(Nt(e)).map(e=>e.peerId),t.dialog_tabs[e]=r.length>=n.length?r:n}return Promise.resolve(t)}function Bt(e,t,n,r){var a=e.dialog_tabs_all;return!(!a[d.h]&&!a[t])||(n.filter(e=>e===r.peerId).length>0||("r"===r.lastmsg[0]||n.map(t=>e.tabs[t.toString()]).filter(t=>Object(u.Bb)(e)?t.lastmsg>r.lastmsg:t.lastmsg<r.lastmsg).length>0))}function Lt(e,t,n,r,a){if(Object(u.Db)(a,e)){var c=a.tabs[e];return n===i.P&&(t^=c.folders),function(e,t,n){return!(e===i.X&&n.folders&t||!(e!==i.T||n.folders&t))}(n,t,c)&&Object.keys(d.j).filter(e=>d.j[e]&t).forEach(e=>{a.dialog_tab_cts[e]+=function(e,t,n){return t!==i.T||e.folders&d.j[n]?t===i.P?e.folders&d.j[n]?-1:1:t===i.X?1:-1:0}(c,n,e)}),n===i.X?a.tabs[e].folders|=t:n===i.T?a.tabs[e].folders&=~t:a.tabs[e].folders=t^=c.folders,Y(a,a.tabs[e],!0,(t,n)=>t.concat([e]).map(e=>a.tabs[e]).filter(Nt(n)).map(e=>e.peerId),Bt.bind(null,a)),Promise.resolve(a)}return C(e,0,0,0,a).then(Lt.bind(null,e,t,n,a))}var Ft=q(function(e,t){var n=d.j[d.i],a=t.tabs[e].folders&n,c=a?i.Fb:i.Jb;return t.longpoll.push([c([0,e,n,!0])]),Object(r.b)(y,{act:"a_dialog_star",val:a?0:1,peer:e,hash:t.tabs[e].hash,gid:t.gid}).then(()=>t)}),Rt=q(function(e,t,n){var a=d.j[d.n];return n.longpoll.push([i.Fb([0,e,a,!0]),i.ub([6,e,t])]),Object(r.b)(y,{act:"a_mark_answered",peer:e,lastmsg:t,hash:n.tabs[e].hash,gid:n.gid}).then(()=>n)});function Ut(e){return Object(r.b)(y,{act:"a_get_mutex_key",gid:e})}function Kt(e,t){return A({[e]:{free:!0}},t),Object(r.b)(y,{act:"a_block_release",peer:e,gid:t.gid}).then(()=>t)}function Xt(e,t){var n=ls.get("comm_mute_"+t.gid)?1:0;return e&&(n^=1),ls.set("comm_mute_"+t.gid,n),t.mute=n,Promise.resolve(t)}var Jt=q(function(e,t){return Y(t,t.tabs[e],!0,t=>t.filter(t=>t!==e)),t.tabs[e].deletedDialog=!0,Object(r.b)(y,{act:"a_delete_dialog",peer:e,gid:t.gid,hash:t.tabs[e].hash}).then(n=>(n[0]?(Gt(t.tabbedPeers.filter(t=>t.peer!==e),!0,t),t.tabs[e].unread=0,t.tabs[e].lastmsg=!1,t.tabs[e].lastmsg_meta=null):(t.tabs[e].deletedDialog=!1,Y(t,t.tabs[e],!1,te.bind(null,e),Bt.bind(null,t))),n))});function Vt(e,t,n,a){return Object(r.b)(y,{act:"a_restore_dialog",hash:t,gid:a.gid,spam:n?1:0,peer:e}).then(t=>(a.tabs[e].deletedDialog=!1,Y(a,a.tabs[e],!1,t=>[e].concat(t)),a.tabs[e].unread=t,a))}function Qt(e,t,n){return Object(r.b)(y,{act:"a_spam_dialog",peer:e,gid:n.gid,hash:t})}function Gt(e,t,n){return n.tabbedPeers=e,Object(u.jb)(n)&&(I({peers:n.tabbedPeers.filter(({peer:e,type:t})=>e!==n.peer&&"perm"===t).map(e=>Object(u.S)(e.peer,n)).filter(e=>!e.deletedDialog).map(e=>e.peerId).map(u.I).join("_"),to:""}),t&&x()),Promise.resolve(n)}function Zt(e){return!e.peer||(Be(e.peer,e)?He(e.peer,e):!!Object(u.qb)(e,e.peer)&&e.tabs[e.peer].allShown)}function Wt(e,t){var n=t.tabs[e];return Object(u.qb)(t,e)&&(n.skipped=null,n.msgs=null,n.offset=null,n.allShown=null,n.history=null),Promise.resolve(t)}function Yt(e,t){var n=t.tabs[e];return Object(u.qb)(t,e)&&(n.history=E(n.history)),Promise.resolve(t)}function en(e,t){return t.go_to_end_visible=e,Promise.resolve(t)}function tn(e,t,n){if(!Object(u.lb)(t))return Promise.resolve(n);var a=Object(l.u)(n,t);return a.blocked_community=!e,!1===e&&(a.can_send_notify=!1),Object(r.b)(y,{act:"a_toggle_community",peer_id:t,hash:a.hash,state:e?1:0}).then(()=>U(n))}function nn(e,t){if(0!==t.peer&&Object(u.qb)(t,t.peer)){var n=Object(l.u)(t,t.peer);n.history=S(n.history),e(n.history)}return Promise.resolve(t)}function rn(e,t){if(0!==t.peer&&Object(u.qb)(t,t.peer)){var n=Object(l.u)(t,t.peer),r=geByClass1("_im_peer_history");r&&(n.history=S(r.innerHTML)),e(n.history)}return Promise.resolve(t)}function an(e){return e.audio_msg.isRecording=!1,Promise.resolve(e)}function cn(e,t){return t.voice_message_available=e,Promise.resolve(t)}function on(e){I({act:e?"create":null}),x()}function sn(e=null){I({q:e}),x()}function un(e){return void 0===e.chatResizeInitialized&&(e.chatResizeInitialized=!0,Object(u.V)()>window.clientHeight()&&Object(u.lc)(0)),Promise.resolve(e)}var dn=q(function(e,t,n){return Object(r.b)(y,{act:"a_join_chat",chat_id:e,hash:t,write_hash:n.writeHash}).then(([e,t,r,a])=>(r.forEach(e=>Object(m.a)(n,e)),n.tabs[e]=t,Y(n,t,!1,te.bind(null,e),Bt.bind(null,n)),n.admins=extend(n.admins,a),[e]))});function ln(e,t){return Object(r.b)(y,{act:"a_get_link",gid:t.gid,chat_id:e})}var fn=q(function(e,t){var n=t.tabs[e];return Object(r.b)(y,{act:"a_reset_link",chat_id:e-2e9,write_hash:t.writeHash}).then(e=>(n.inviteLink=e[0],e))});function mn(e){return P({invite_chat_id:null,invite_hash:null}),e.invitation=void 0,Promise.resolve(e)}function bn(e,t){var n=Object(o.a)([e].concat(t.select(s.b))).slice(0,500);t.update(s.b,n)}function _n(e){e.update(s.b,[])}function hn(e,t){var n=t.select(s.b).filter(t=>t!==e);return t.update(s.b,n),n}function pn(e,t,n){var r=n.tabs[t],a=Object(l.n)(n,t,e);return r.data.kicked||r.data.closed||a.kludges.source_act||(r.pinned=a),Promise.resolve(n)}function gn(e,t){return t.tabs[e].pinned=null,Promise.resolve(t)}var vn=q(function(e,t,n){var a=n.tabs[t];return a.data.kicked||a.data.closed?Promise.resolve(n):Object(r.b)(y,{act:"a_pin_message",msgid:e,chat:t,gid:n.gid,hash:n.tabs[t].hash}).then(([e])=>(n.tabs[t]=Object.assign({},a,e),n))}),jn=q(function(e,t){var n=t.tabs[e];return n.data.kicked||n.data.closed?Promise.resolve(t):Object(r.b)(y,{act:"a_unpin_message",chat:e,gid:t.gid,hash:t.tabs[e].hash}).then(([r])=>(t.tabs[e]=Object.assign({},n,r),t))}),yn=q(function(e,t){var n=t.tabs[e];return Object(r.b)(y,{act:"a_get_pinned_message",chat:e,gid:t.gid,hash:t.tabs[e].hash}).then(([e])=>(n.pinned=e||null,t))}),kn=q(function(e,t,n){var a=n.tabs[e];return Object(r.b)(y,{act:"a_get_message_local_id",chat:e,chat_local_id:t,hash:a.hash})}),On=q(function(e,t){var n=t.tabs[e];return n.membersLoaded?Promise.resolve(t):Object(r.b)(y,{act:"a_get_chat_members",chat:e,gid:t.gid,hash:n.hash}).then(([[e,r,a]])=>(n.memberIds=e,n.adminIds=r,a.forEach(e=>Object(m.a)(t,e)),n.membersLoaded=!0,t))}),wn=q(function(e,t){return Promise.all([On(e,t),function(e,t){var n=t.tabs[e];return Object(r.b)(y,{act:"a_get_chat_details",chat:e,gid:t.gid,hash:n.hash}).then(([e])=>(n.photoGrid=e.grid,n.photoLarge=e.photo,n.membersLastSeen=e.lastSeen||null,n.inviters=e.inviters,n.caccess=e.caccess,n.invitedByMe=e.invitedByMe||[],n.inviteLink=e.link||null,n.serverSettings=e.serverSettings||null,t))}(e,t)]).then(()=>t)}),In=q(function(e,t,n){var a=n.tabs[e];return Object(r.b)(y,{act:"a_update_flags",chat:e,hash:a.hash,flags:t})}),xn=q(function(e,t){var n=t.tabs[e];return Object(r.b)("al_page.php",{act:"owner_photo_remove",oid:e,gid:t.gid,hash:n.photoHash}).then(()=>(n.photo=null,n.photoLarge=null,t))});function Pn(e,t,n){var r=n.tabs[e];return r.memberIds=r.memberIds.filter(e=>e!==t),r.adminIds=r.adminIds.filter(e=>e!==t),r.membersCount=r.memberIds.length,Promise.resolve(n)}var Dn=q(function(e,t,n){var a=n.tabs[e];return Object(r.b)(y,{act:"a_kick_user",chat:e,hash:a.hash,mid:t}).then(()=>(a.memberIds=a.memberIds.filter(e=>e!==t),a.adminIds=a.adminIds.filter(e=>e!==t),a.membersCount=a.memberIds.length,n))});function $n(e,t,n,r){var a=r.tabs[e];return a.adminIds=n?[].concat(a.adminIds,t).filter((e,t,n)=>n.indexOf(e)===t):a.adminIds.filter(e=>e!==t),Promise.resolve(r)}var Tn=q(function(e,t,n,a){var i=a.tabs[e];return Object(r.b)(y,{act:"a_toggle_admin",chat:e,hash:i.hash,mid:t,is_admin:+n}).then(()=>$n(e,t,n,a))});function qn(e,t,n,r){var a=Object(l.n)(e,n,t).userId;return Object(m.c)(r,a)?Promise.resolve(r):lt({[n]:[a]},r)}function Sn(){ajax.post("al_im.php",{act:"a_hide_promo_tooltip"})}function En(){cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()}var An=q(function(e,t){return t.tabs[e].top_banner=void 0,Object(r.b)(y,{act:"a_hide_banner",peer_id:e,gid:t.gid,hash:t.tabs[e].hash}).then(()=>t)}),Cn=q(function(e,t,n){n.tabs[e].top_banner=void 0;var a=n.tabs[e];return Object(r.b)(y,{act:"a_callback_banner",peer_id:e,callback_data:t,hash:a.hash}).then(()=>n)});function zn(e,t){return Object(r.b)(y,{act:"a_load_banner",peer_id:e,gid:t.gid}).then(([n])=>(t.tabs[e].top_banner=n,t))}function Mn(e,t,n){return n.tabs[e].keyboard=t&&t.buttons?t:null,Hn(e,!1,!0,n)}function Nn(e,t){return Mn(e,null,t)}function Hn(e,t,n,r){return((r.tabs||{})[e]||{}).keyboard&&(r.tabs[e].keyboard.hide=t,n&&ls.set("is_keyboards_hide",Object.assign(ls.get("is_keyboards_hide")||{},{[e]:t}))),Promise.resolve(r)}var Bn=q(function(e,t){var n=t.tabs[e];return Object(r.b)(y,{act:"a_get_keyboard",peer_id:e,hash:n.hash}).then(([n])=>Mn(e,n,t))});function Ln(e,t,n,a){var i=a.tabs[e];return i.caccess[t]=n,Object(r.b)(y,{act:"a_change_caccess",peer_id:e,member_id:t,hash:i.hash,access:n?1:0}).then(()=>a).catch(e=>{throw i.caccess[t]=!n,e})}var Fn=q(function(e,t){var n=t.tabs[t.peer];return Object(r.b)(y,{act:"a_delete_template",template_id:e,hash:n.hash,gid:t.gid,peer_id:t.peer}).then(()=>{var n=t.templates.find(t=>t.id===e);return n&&(n.deleted=!0),t})});function Rn(e,t,n){var a=n.tabs[n.peer];return Object(r.b)(y,{act:"a_create_template",hash:a.hash,gid:n.gid,peer_id:n.peer,name:e,text:t}).then(e=>(n.templates.unshift(e[0]),n))}function Un(e,t,n,a){var i=a.tabs[a.peer];return Object(r.b)(y,{act:"a_update_template",template_id:e,hash:i.hash,gid:a.gid,peer_id:a.peer,group_id:a.gid,name:t,text:n}).then(t=>{var n=a.templates.find(t=>t.id===e);return n&&Object.assign(n,t[0]),a})}function Kn(e,t){if(Object(u.qb)(t,e)){var n=Object(l.u)(t,e);n.allShown=!1,n.lastReset=Date.now()}return t}function Xn(e,t){var{updateType:n,updateArg:r}=e,a=0;return n===i.A&&(a=r===i.G?1:-1),n===i.x&&(a=-1),t.dialog_tab_cts[d.k]+=a,Promise.resolve(t)}},"wSs/":function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"d",function(){return f});n("Vd3H"),n("rGqo"),n("Btvt"),n("pIFo");var r=n("rHUl"),a=n("MhhX"),i=n("P13b"),c=n("eTng"),o=n("aong");function s(e,t){t=Object(r.S)(t);var n=vk.id==t.peerId&&!Object(o.r)(e).gid;return 333!=t.peerId&&(!(!n&&!Object(a.k)(t))&&(!Object(a.l)(t)&&(!(Date.now()/1e3-t.date>86400)&&(!(Object(a.f)(t)||Object(a.m)(t)||Object(a.d)(t)||Object(a.g)(t)||Object(a.i)(t)||Object(a.o)(t))&&!Object(i.gb)(e,t.peerId,t.messageId)))))}function u(e){var t=document.createElement("div");return e=e.replace(/\[((id|club)\d+)\|(.+?)]/g,(...e)=>{var t=e[1],n=e[3];return/^\@/.test(n)?n:`@${t} (${n})`}),t.innerHTML=e,Emoji.val(t)}function d(e,t){return+(t&&t.msgs?Object.keys(t.msgs):[]).filter(e=>e>0).sort((e,t)=>t-e).find(n=>s(e,t.msgs[n]))||null}function l(e,t,n){var r=Object(c.a)(t.kludges,t.messageId),a=n.dData.attaches;if(u(t.text)!==n.dData.txt||r.length!==a.length)return!0;for(var i=r.length;i--;){var o=r[i],s=a[i];if(o.id!=s.id||o.type!=s.type||"poll"==o.type&&s.object&&s.object.poll_is_edited)return!0}return!1}function f(e,t,n,r,a,c){t.origText=n,t.text=Object(i.hc)(clean(n)).replace(/\n/gi,"<br>"),t.attaches=r,t.kludges.emoji=1,t.local=1,t.share_url=a,t.cancelled_shares=c,t.update_time=Math.floor(Date.now()/1e3),e.get().tabs[t.peerId].msgs[t.messageId]=t}}}]);try{stManager.done("cmodules/bundles/37d6fe1fee6fb6accf5867cbca2cda9c.c25a2dd7e40fed5d08af.js")}catch(e){}